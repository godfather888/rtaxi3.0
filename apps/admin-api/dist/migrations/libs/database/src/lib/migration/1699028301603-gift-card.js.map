{"version":3,"sources":["../../../../../../../../../libs/database/src/lib/migration/1699028301603-gift-card.ts"],"sourcesContent":["import { MigrationInterface, QueryRunner } from 'typeorm';\n\nexport class GiftCard1699028301603 implements MigrationInterface {\n  public async up(queryRunner: QueryRunner): Promise<void> {\n    try {\n      await queryRunner.query(\n        'CREATE TABLE `gift` (`id` int NOT NULL PRIMARY KEY AUTO_INCREMENT, `currency` varchar(3) NOT NULL, `amount` float(10,2) NOT NULL, `availableFrom` datetime NOT NULL, `expireAt` datetime NOT NULL);',\n      );\n    } catch (error) {\n      console.error(error);\n    }\n    try {\n      await queryRunner.query(\n        'CREATE TABLE `gift_card` (`id` int NOT NULL AUTO_INCREMENT PRIMARY KEY, `code` varchar(255) NOT NULL, `amount` float(10,2) NOT NULL, `availableTimestamp` datetime NOT NULL, `expirationTimestamp` datetime NOT NULL, `isUsed` tinyint NOT NULL, `currency` varchar(3) NOT NULL);',\n      );\n    } catch (error) {\n      console.error(error);\n    }\n    try {\n      await queryRunner.query(\n        'ALTER TABLE `rider_transaction` ADD COLUMN `giftCardId` int DEFAULT NULL;',\n      );\n      await queryRunner.query(\n        'ALTER TABLE `rider_transaction` ADD CONSTRAINT FOREIGN KEY (`giftCardId`) REFERENCES `gift_card`(`id`) ON DELETE SET NULL ON UPDATE NO ACTION;',\n      );\n    } catch (error) {\n      console.error(error);\n    }\n    try {\n      await queryRunner.query(\n        'ALTER TABLE `driver_transaction` ADD COLUMN `giftCardId` int DEFAULT NULL;',\n      );\n      await queryRunner.query(\n        'ALTER TABLE `driver_transaction` ADD CONSTRAINT FOREIGN KEY (`giftCardId`) REFERENCES `gift_card`(`id`) ON DELETE SET NULL ON UPDATE NO ACTION;',\n      );\n    } catch (error) {\n      console.error(error);\n    }\n  }\n\n  public async down(queryRunner: QueryRunner): Promise<void> {}\n}\n"],"names":["GiftCard1699028301603","up","queryRunner","query","error","console","down"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;+BAEaA;;;eAAAA;;;AAAN,IAAA,AAAMA,wBAAN,MAAMA;IACX,MAAaC,GAAGC,WAAwB,EAAiB;QACvD,IAAI;YACF,MAAMA,YAAYC,KAAK,CACrB;QAEJ,EAAE,OAAOC,OAAO;YACdC,QAAQD,KAAK,CAACA;QAChB;QACA,IAAI;YACF,MAAMF,YAAYC,KAAK,CACrB;QAEJ,EAAE,OAAOC,OAAO;YACdC,QAAQD,KAAK,CAACA;QAChB;QACA,IAAI;YACF,MAAMF,YAAYC,KAAK,CACrB;YAEF,MAAMD,YAAYC,KAAK,CACrB;QAEJ,EAAE,OAAOC,OAAO;YACdC,QAAQD,KAAK,CAACA;QAChB;QACA,IAAI;YACF,MAAMF,YAAYC,KAAK,CACrB;YAEF,MAAMD,YAAYC,KAAK,CACrB;QAEJ,EAAE,OAAOC,OAAO;YACdC,QAAQD,KAAK,CAACA;QAChB;IACF;IAEA,MAAaE,KAAKJ,WAAwB,EAAiB,CAAC;AAC9D"}