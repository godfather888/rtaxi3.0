"use strict";(self.webpackChunkadmin_panel=self.webpackChunkadmin_panel||[]).push([[128],{6128:($,b,o)=>{o.r(b),o.d(b,{ManagementSMSProviderModule:()=>ie});var g=o(8434),P=o(2067),C=o(5885),I=o(7624),S=o(467),m=o(9417),d=o(3241),i=o(4843),e=o(1360),u=o(2209),a=o(712),s=o(6501),v=o(3617),c=o(1011),f=o(513),h=o(6389),M=o(5930),_=o(7529),j=o(8927),G=o(1997),T=o(3062),k=o(7685),R=o(8018);function E(n,p){if(1&n){const t=e.RV6();e.j41(0,"button",15),e.bIt("click",function(){e.eBV(t);const l=e.XpG(2);return e.Njj(l.markAsDefault())}),e.EFF(1,"Mark as default"),e.k0s()}}function x(n,p){if(1&n&&(e.j41(0,"div"),e.DNE(1,E,2,0,"button",14),e.nI1(2,"async"),e.k0s()),2&n){let t;const r=e.XpG();e.R7$(),e.Y8G("ngIf",!1===(null==(t=e.bMT(2,1,r.route.data))||null==t.smsProvider?null:t.smsProvider.isDefault))}}function A(n,p){if(1&n&&(e.j41(0,"button",16),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&n){const t=e.XpG();e.Y8G("disabled",t.form.invalid),e.R7$(),e.SpI(" ",e.bMT(2,2,"profile.saveChanges")," ")}}function L(n,p){if(1&n&&e.nrm(0,"nz-option",17),2&n){const t=p.$implicit;e.Y8G("nzValue",t)("nzLabel",t)}}function Q(n,p){if(1&n&&(e.j41(0,"nz-form-item")(1,"nz-form-label",19),e.EFF(2),e.k0s(),e.j41(3,"nz-form-control"),e.nrm(4,"input",20),e.k0s()()),2&n){const t=e.XpG().ngIf;e.R7$(2),e.JRh(t.accountId)}}function Y(n,p){if(1&n&&(e.j41(0,"nz-form-item")(1,"nz-form-label",21),e.EFF(2),e.k0s(),e.j41(3,"nz-form-control"),e.nrm(4,"input",22),e.k0s()()),2&n){const t=e.XpG().ngIf;e.R7$(2),e.JRh(t.authToken)}}function U(n,p){if(1&n&&(e.j41(0,"nz-form-item")(1,"nz-form-label",23),e.EFF(2),e.k0s(),e.j41(3,"nz-form-control"),e.nrm(4,"input",24),e.k0s()()),2&n){const t=e.XpG().ngIf;e.R7$(2),e.JRh(t.fromNumber)}}function X(n,p){if(1&n&&(e.j41(0,"nz-form-item")(1,"nz-form-label",25),e.EFF(2),e.k0s(),e.j41(3,"nz-form-control"),e.nrm(4,"input",26),e.k0s()()),2&n){const t=e.XpG().ngIf;e.R7$(2),e.JRh(t.smsType)}}function w(n,p){if(1&n&&(e.j41(0,"nz-form-item")(1,"nz-form-label",27),e.EFF(2),e.k0s(),e.j41(3,"nz-form-control"),e.nrm(4,"input",28),e.k0s()()),2&n){const t=e.XpG().ngIf;e.R7$(2),e.JRh(t.verificationTemplate)}}function K(n,p){1&n&&e.nrm(0,"nz-alert",29)}function B(n,p){if(1&n&&(e.j41(0,"div")(1,"div",5),e.DNE(2,Q,5,1,"nz-form-item",12)(3,Y,5,1,"nz-form-item",12)(4,U,5,1,"nz-form-item",12)(5,X,5,1,"nz-form-item",12)(6,w,5,1,"nz-form-item",12),e.k0s(),e.DNE(7,K,1,0,"nz-alert",18),e.k0s()),2&n){const t=p.ngIf;e.R7$(2),e.Y8G("ngIf",t.accountId),e.R7$(),e.Y8G("ngIf",t.authToken),e.R7$(),e.Y8G("ngIf",t.fromNumber),e.R7$(),e.Y8G("ngIf",t.smsType),e.R7$(),e.Y8G("ngIf",t.verificationTemplate),e.R7$(),e.Y8G("ngIf",t.verificationTemplate)}}let V=(()=>{class n{route;fb;updateGQL;createGQL;markAsDefaultGQL;routerHelper;modalService;constructor(t,r,l,z,F,ae,se){this.route=t,this.fb=r,this.updateGQL=l,this.createGQL=z,this.markAsDefaultGQL=F,this.routerHelper=ae,this.modalService=se,this.form=this.fb.group({id:[null],name:[null,m.k0.required],type:[null,m.k0.required],accountId:[null],authToken:[null],verificationTemplate:[null],fromNumber:[null],smsType:[null]})}form;subscription;smsProviders=[d.dxu.Twilio,d.dxu.BroadNet,d.dxu.Plivo,d.dxu.Vonage,d.dxu.Pahappa,d.dxu.VentisSms,d.dxu.SMSC];jwt=localStorage.getItem("ridy_admin_token");ngOnInit(){this.subscription=this.route.data.subscribe(t=>{this.form.patchValue(t.smsProvider.data.smsProvider)})}ngOnDestroy(){this.subscription?.unsubscribe()}onSubmit(){var t=this;return(0,S.A)(function*(){console.log("Form submitted",t.form.value);const{id:r,...l}=t.form.value;var z;null==r?t.modalService.create({nzTitle:"Default SMS Provider",nzContent:"Do you want to set this as the default SMS provider?",nzOnOk:(z=(0,S.A)(function*(){console.log("create",l),yield(0,i._)(t.createGQL.mutate({input:{...l,isDefault:!0}})),t.routerHelper.goToParent(t.route)}),function(){return z.apply(this,arguments)}),nzOnCancel:function(){var z=(0,S.A)(function*(){yield(0,i._)(t.createGQL.mutate({input:l})),t.routerHelper.goToParent(t.route)});return function(){return z.apply(this,arguments)}}()}):(yield(0,i._)(t.updateGQL.mutate({id:r,input:l})),t.routerHelper.goToParent(t.route))})()}getProviderAPIRequirements(t){if(null==t)return null;switch(t){case d.dxu.Twilio:return{accountId:"Account SID",authToken:"Auth Token",fromNumber:"From Number",verificationTemplate:"Verification Template"};case d.dxu.BroadNet:return{accountId:"Username",authToken:"Password",fromNumber:"From Number",smsType:"SMS Type",verificationTemplate:"Verification Template"};case d.dxu.Plivo:return{accountId:"Auth ID",authToken:"Auth Token",fromNumber:"Sender ID",verificationTemplate:"Verification Template"};case d.dxu.Vonage:return{accountId:"API Key",authToken:"API Secret",fromNumber:"From Number",verificationTemplate:"Verification Template"};case d.dxu.Pahappa:return{accountId:"Username",authToken:"Password",fromNumber:"Sender",verificationTemplate:"Verification Template"};case d.dxu.VentisSms:return{accountId:"Username",smsType:"Password",authToken:"Client Secret",fromNumber:"Sender",verificationTemplate:"Verification Template"};case d.dxu.SMSC:return{accountId:"Login",authToken:"Password",fromNumber:"Sender",verificationTemplate:"Verification Template"};default:return null}}markAsDefault(){var t=this;return(0,S.A)(function*(){const r=t.form.get("id")?.value;null!=r&&(yield(0,i._)(t.markAsDefaultGQL.mutate({id:r})),t.routerHelper.goToParent(t.route))})()}static \u0275fac=function(r){return new(r||n)(e.rXU(u.nX),e.rXU(m.ze),e.rXU(d.AvA),e.rXU(d.lEK),e.rXU(d.Xgf),e.rXU(a.T),e.rXU(s.N_))};static \u0275cmp=e.VBU({type:n,selectors:[["app-sms-provider-view"]],standalone:!1,decls:26,vars:8,consts:[["nz-form","","nzLayout","vertical",3,"ngSubmit","formGroup"],["nzBackIcon","","nzTitle","SMS Provider","nzSubtitle","Manage SMS providers for sending verification codes",3,"nzGhost"],[4,"nzSpaceItem"],["nz-button","","nzType","primary","type","submit",3,"disabled",4,"nzSpaceItem"],["formControlName","id","type","hidden","hidden",""],[1,"lg:grid","lg:grid-cols-4","lg:gap-2"],["nzRequired","","nzFor","name"],["nz-input","","required","","id","name","formControlName","name"],["nzRequired","","nzFor","type"],["formControlName","type","id","type"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],[1,"my-2","text-sm"],[4,"ngIf"],["nz-button","","nzType","primary","type","submit",1,"float-right",3,"disabled"],["nz-button","","nzType","default",3,"click",4,"ngIf"],["nz-button","","nzType","default",3,"click"],["nz-button","","nzType","primary","type","submit",3,"disabled"],[3,"nzValue","nzLabel"],["nzType","info","nzMessage","Verification code template","nzDescription","Use the following variables in your template: {code} as placeholder for the verification code.","nzShowIcon","",4,"ngIf"],["nzFor","accountId"],["nz-input","","formControlName","accountId","id","accountId"],["nzFor","authToken"],["nz-input","","formControlName","authToken","id","authToken"],["nzFor","fromNumber"],["nz-input","","formControlName","fromNumber","id","fromNumber"],["nzFor","smsType"],["nz-input","","formControlName","smsType","id","smsType"],["nzFor","verificationTemplate"],["nz-input","","formControlName","verificationTemplate","id","verificationTemplate"],["nzType","info","nzMessage","Verification code template","nzDescription","Use the following variables in your template: {code} as placeholder for the verification code.","nzShowIcon",""]],template:function(r,l){1&r&&(e.j41(0,"form",0),e.bIt("ngSubmit",function(){return l.onSubmit()}),e.j41(1,"nz-page-header",1)(2,"nz-page-header-extra")(3,"nz-space"),e.DNE(4,x,3,3,"div",2)(5,A,3,4,"button",3),e.k0s()(),e.j41(6,"nz-page-header-content"),e.nrm(7,"input",4),e.j41(8,"div",5)(9,"nz-form-item")(10,"nz-form-label",6),e.EFF(11,"Name"),e.k0s(),e.j41(12,"nz-form-control"),e.nrm(13,"input",7),e.k0s()(),e.j41(14,"nz-form-item")(15,"nz-form-label",8),e.EFF(16,"Type"),e.k0s(),e.j41(17,"nz-form-control")(18,"nz-select",9),e.DNE(19,L,1,2,"nz-option",10),e.k0s()()()(),e.j41(20,"h3",11),e.EFF(21,"API Keys"),e.k0s(),e.DNE(22,B,8,6,"div",12),e.k0s(),e.j41(23,"button",13),e.EFF(24),e.nI1(25,"translate"),e.k0s()()()),2&r&&(e.Y8G("formGroup",l.form),e.R7$(),e.Y8G("nzGhost",!1),e.R7$(18),e.Y8G("ngForOf",l.smsProviders),e.R7$(3),e.Y8G("ngIf",l.getProviderAPIRequirements(l.form.value.type)),e.R7$(),e.Y8G("disabled",l.form.invalid),e.R7$(),e.JRh(e.bMT(25,6,"profile.submit")))},dependencies:[g.Sq,g.bT,m.qT,m.me,m.BC,m.cb,m.YS,m.j4,m.JD,v.Y,c.Sy,f.aO,h.c,M.p,_.Uq,_.e,j.CA,j.Ls,j.Mo,j.zS,G.ld,G.WI,T.WB,T.zR,T.ov,k.U5,k.Dq,g.Jj,R.D9],encapsulation:2})}return n})(),D=(()=>{class n{gql;constructor(t){this.gql=t}resolve(t){return this.gql.fetch({id:t.params.id})}static \u0275fac=function(r){return new(r||n)(e.KVO(d.COw))};static \u0275prov=e.jDH({token:n,factory:n.\u0275fac})}return n})();var O=o(6807),H=o(7094);let N=(()=>{class n{paging;gql;messageService;constructor(t,r,l){this.paging=t,this.gql=r,this.messageService=l}resolve(t){const r=this.paging.deserializeQueryParams(t.queryParams),l=this.gql.fetch(r);return l.subscribe({error:z=>{this.messageService.error("This role does not have the permission to access this menu.")}}),l}static \u0275fac=function(r){return new(r||n)(e.KVO(O.a),e.KVO(d.E17),e.KVO(H.xh))};static \u0275prov=e.jDH({token:n,factory:n.\u0275fac})}return n})();var J=o(8204),y=o(3359),W=o(1951),Z=o(5699),q=o(8852);function ee(n,p){1&n&&(e.j41(0,"nz-tag",12),e.EFF(1,"Default"),e.k0s())}function te(n,p){if(1&n&&(e.j41(0,"tr",7)(1,"td")(2,"div",8)(3,"div")(4,"div")(5,"span",9),e.EFF(6),e.k0s(),e.DNE(7,ee,2,0,"nz-tag",10),e.k0s(),e.j41(8,"div")(9,"span",11),e.EFF(10),e.k0s()()()()()()),2&n){const t=p.$implicit;e.Y8G("routerLink","view/"+t.id),e.R7$(6),e.SpI("",t.name," "),e.R7$(),e.Y8G("ngIf",t.isDefault),e.R7$(3),e.SpI("Provider: ",t.type,"")}}function ne(n,p){if(1&n){const t=e.RV6();e.j41(0,"nz-table",5,0),e.bIt("nzQueryParams",function(l){e.eBV(t);const z=e.XpG();return e.Njj(z.tableService.onTableQueryParamsChange(l))}),e.j41(2,"thead")(3,"tr")(4,"th"),e.EFF(5),e.nI1(6,"translate"),e.k0s()()(),e.j41(7,"tbody"),e.DNE(8,te,11,4,"tr",6),e.k0s()()}if(2&n){const t=p.ngIf,r=e.sdS(1);e.Y8G("nzFrontPagination",!1)("nzData",t.nodes)("nzTotal",t.totalCount),e.R7$(5),e.SpI(" ",e.bMT(6,5,"profile.name")," "),e.R7$(3),e.Y8G("ngForOf",r.data)}}const re=[{path:"",component:(()=>{class n{route;tableService;serverUrl=J.c.root;constructor(t,r){this.route=t,this.tableService=r}static \u0275fac=function(r){return new(r||n)(e.rXU(u.nX),e.rXU(O.a))};static \u0275cmp=e.VBU({type:n,selectors:[["app-sms-provider-list"]],standalone:!1,decls:9,vars:7,consts:[["table",""],["nzBackIcon","","nzTitle","SMS Providers","nzSubtitle","Manage SMS providers for sending verification codes",3,"nzGhost"],["nz-button","","nzType","primary","routerLink","new"],["nz-icon","","nzType","plus"],["nzShowSizeChanger","","nzBordered","",3,"nzFrontPagination","nzData","nzTotal","nzQueryParams",4,"ngIf"],["nzShowSizeChanger","","nzBordered","",3,"nzQueryParams","nzFrontPagination","nzData","nzTotal"],["class","group cursor-pointer",3,"routerLink",4,"ngFor","ngForOf"],[1,"group","cursor-pointer",3,"routerLink"],[1,"flex","items-center","ml-2"],["nz-typography","",1,"mr-2"],["nzColor","green",4,"ngIf"],["nz-typography","","nzType","secondary"],["nzColor","green"]],template:function(r,l){if(1&r&&(e.j41(0,"nz-page-header",1)(1,"nz-page-header-extra")(2,"button",2),e.nrm(3,"i",3),e.EFF(4),e.nI1(5,"translate"),e.k0s()(),e.j41(6,"nz-page-header-content"),e.DNE(7,ne,9,7,"nz-table",4),e.nI1(8,"async"),e.k0s()()),2&r){let z;e.Y8G("nzGhost",!1),e.R7$(4),e.JRh(e.bMT(5,3,"profile.add")),e.R7$(3),e.Y8G("ngIf",null==(z=e.bMT(8,5,l.route.data))||null==z.smsProviders||null==z.smsProviders.data?null:z.smsProviders.data.smsProviders)}},dependencies:[g.Sq,g.bT,I.Wk,y.CP,y.SO,y._4,y.IL,y.aj,y.kt,f.aO,h.c,M.p,W.Dn,Z.s,T.WB,T.zR,T.ov,q.Di,g.Jj,R.D9],encapsulation:2})}return n})(),resolve:{smsProviders:N},runGuardsAndResolvers:"paramsOrQueryParamsChange"},{path:"view/:id",component:V,resolve:{smsProvider:D}},{path:"new",component:V}];let oe=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=e.$C({type:n});static \u0275inj=e.G2t({providers:[N,D],imports:[I.iI.forChild(re),I.iI]})}return n})(),ie=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=e.$C({type:n});static \u0275inj=e.G2t({providers:[P.t],imports:[g.MD,oe,C.G]})}return n})()},6807:($,b,o)=>{o.d(b,{a:()=>C});var g=o(1360),P=o(2209);let C=(()=>{class m{router;route;constructor(i,e){this.router=i,this.route=e}serializeQueryParams(i,e){const u={};if(u.pageIndex=i.pageIndex,u.pageSize=i.pageSize,null!=i.filter){const a=i.filter.filter(s=>null!=s.value&&s.value.length>0).map(s=>`${s.key}|${Array.isArray(s.value)?"in":"eq"}|${Array.isArray(s.value)?s.value.join("-"):s.value}`);null!=e.filter&&a.push(...e.filter.split(",")),u.filter=a.length>0?a.join(","):void 0}if(null!=i.sort&&i.sort.length>0){const a=i.sort.filter(s=>null!=s.value).map(s=>`${s.key}|${"ascend"==s.value?"ASC":"DESC"}`);null!=e.sort&&a.push(...e.sort.split(",")),u.sort=a.length>0?a.join(","):void 0}return u}onTableQueryParamsChange(i){const e=this.serializeQueryParams(i,this.route.snapshot.queryParams);this.router.navigate([],{relativeTo:this.route,queryParams:e,queryParamsHandling:"merge"})}filterText(i,e){const a=this.deserializeQueryParams(this.route).filter??{};a[i]=null!=e?{like:e}:{};const s=Object.keys(a).map(c=>{if(Object.keys(a[c]).length<1)return null;const f=Object.keys(a[c])[0];return`${c}|${f}|${"in"==f?a[c][f].join("-"):a[c][f]}`}).filter(c=>null!=c),v=s.length>0?s.join(","):void 0;this.router.navigate([],{relativeTo:this.route,queryParams:{filter:v},queryParamsHandling:"merge"})}filterRange(i,e){const a=this.deserializeQueryParams(this.route).filter??{};a[i]=null!=e?{between:e}:{};const s=Object.keys(a).map(c=>{if(Object.keys(a[c]).length<1)return null;const f=Object.keys(a[c])[0];return`${c}|${f}|${"in"==f||"between"==f?a[c][f].join("-"):a[c][f]}`}).filter(c=>null!=c),v=s.length>0?s.join(","):void 0;this.router.navigate([],{relativeTo:this.route,queryParams:{filter:v},queryParamsHandling:"merge"})}resetFilter(i,e){this.filterText(i,void 0),e.value=""}downloadURI(i,e){const u=document.createElement("a");u.download=e,u.href=i,u.target="_blank",document.body.appendChild(u),u.click(),document.body.removeChild(u)}deserializeQueryParams(i){const e=i.sort?i.sort.split(",").map(v=>({field:v.split("|")[0],direction:v.split("|")[1]})):[],u={};null!=i.filter&&i.filter.split(",").forEach(v=>{const c={},f=v.split("|")[1];if("in"==f){const h=v.split("|")[2].split("-");c[f]=h}else if("between"==f){const h=v.split("|")[2].split("-");c[f]={lower:h[0],upper:h[1]}}else c[f]=v.split("|")[2];u[v.split("|")[0]]=c});const a=null!=i.pageIndex?parseInt(i.pageIndex):1,s=null!=i.pageSize?parseInt(i.pageSize):10;return{sorting:e.length>0?e:void 0,paging:{offset:(a-1)*s,limit:s},filter:null!=u&&Object.keys(u).length>0?u:void 0}}static \u0275fac=function(e){return new(e||m)(g.KVO(P.Ix),g.KVO(P.nX))};static \u0275prov=g.jDH({token:m,factory:m.\u0275fac,providedIn:"root"})}return m})()}}]);