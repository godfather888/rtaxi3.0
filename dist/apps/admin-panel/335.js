"use strict";(self.webpackChunkadmin_panel=self.webpackChunkadmin_panel||[]).push([[335],{335:(rt,S,i)=>{i.r(S),i.d(S,{SOSViewModule:()=>nt});var u=i(7624),h=i(467),d=i(3241),R=i(2067),I=i(6354),F=i(4843),b=i(9933),t=i(1360),T=i(2209),y=i(712),$=i(7094),c=i(8434),z=i(6057),Y=i(5699),p=i(3062),f=i(2e3),G=i(5703),A=i(8018),j=i(3409);function V(r,s){1&r&&(t.j41(0,"a",7),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&r&&(t.R7$(),t.JRh(t.bMT(2,1,"profile.details")))}function x(r,s){if(1&r&&(t.j41(0,"nz-page-header")(1,"nz-page-header-title"),t.EFF(2),t.k0s(),t.j41(3,"nz-page-header-tags")(4,"nz-tag",1),t.EFF(5),t.nI1(6,"translate"),t.k0s()(),t.j41(7,"nz-page-header-content")(8,"div",2)(9,"div",3)(10,"nz-descriptions")(11,"nz-descriptions-item",4),t.nI1(12,"translate"),t.EFF(13),t.nI1(14,"timeago"),t.k0s(),t.j41(15,"nz-descriptions-item",4),t.nI1(16,"translate"),t.EFF(17),t.k0s()()()()(),t.j41(18,"nz-page-header-footer")(19,"nz-tabset",5)(20,"nz-tab"),t.DNE(21,V,3,3,"a",6),t.k0s()(),t.nrm(22,"router-outlet"),t.k0s()()),2&r){const n=s.ngIf,e=t.XpG();t.R7$(2),t.SpI("#",n.id,""),t.R7$(2),t.Y8G("nzColor",e.tagColor.sosStatus(n.status))("nzBordered",!1),t.R7$(),t.JRh(t.bMT(6,10,"enum.sosStatus."+e.camelCase(n.status))),t.R7$(6),t.FS9("nzTitle",t.bMT(12,12,"complaint.inscriptionTime")),t.Y8G("nzSpan",1),t.R7$(2),t.SpI("",t.bMT(14,14,n.createdAt)," "),t.R7$(2),t.FS9("nzTitle",t.bMT(16,16,"profile.submittedBy")),t.Y8G("nzSpan",2),t.R7$(2),t.JRh(n.submittedByRider?"Rider":"Driver")}}let k=(()=>{class r{route;tagColor;updateGql;routerHelper;msg;query;camelCase=b.xQ;complaintStatus=d.ywf;constructor(n,e,o,a,g){this.route=n,this.tagColor=e,this.updateGql=o,this.routerHelper=a,this.msg=g}ngOnInit(){this.query=this.route.data.pipe((0,I.T)(n=>n.sos))}updateStatus(n){var e=this;return(0,h.A)(function*(){yield(0,F._)(e.updateGql.mutate({id:e.route.snapshot.params.id,status:n})),e.routerHelper.refresh(e.route),e.msg.success("Updated!")})()}static \u0275fac=function(e){return new(e||r)(t.rXU(T.nX),t.rXU(R.t),t.rXU(d.dQT),t.rXU(y.T),t.rXU($.xh))};static \u0275cmp=t.VBU({type:r,selectors:[["app-sos-view"]],standalone:!1,decls:3,vars:3,consts:[[4,"ngIf"],[3,"nzColor","nzBordered"],[1,"content"],[1,"main"],[3,"nzTitle","nzSpan"],["nzLinkRouter","",1,"mb-2"],["nz-tab-link","","routerLink","info",4,"nzTabLink"],["nz-tab-link","","routerLink","info"]],template:function(e,o){if(1&e&&(t.j41(0,"nz-card"),t.DNE(1,x,23,18,"nz-page-header",0),t.nI1(2,"async"),t.k0s()),2&e){let a;t.R7$(),t.Y8G("ngIf",null==(a=t.bMT(2,1,o.query))||null==a.data?null:a.data.distressSignal)}},dependencies:[T.n3,u.Wk,c.bT,z.JZ,z.rE,z.v3,z.rM,Y.s,p.WB,p.k9,p.zR,p.cC,p.F0,f.xA,f.gr,G.cK,c.Jj,A.D9,j.PZ],encapsulation:2})}return r})();var l=i(9417),m=i(3359),O=i(1011),L=i(513),X=i(6389),B=i(5930),M=i(7529),v=i(8927),C=i(1997),N=i(3146),U=i(5154),J=i(314);function D(r,s){if(1&r&&(t.j41(0,"nz-descriptions",2),t.nI1(1,"translate"),t.j41(2,"nz-descriptions-item",3),t.nI1(3,"translate"),t.EFF(4),t.k0s(),t.j41(5,"nz-descriptions-item",3),t.nI1(6,"translate"),t.j41(7,"a",19),t.EFF(8),t.nI1(9,"phone"),t.k0s()(),t.j41(10,"nz-descriptions-item",3),t.nI1(11,"translate"),t.EFF(12),t.nI1(13,"date"),t.k0s(),t.j41(14,"nz-descriptions-item",4),t.nI1(15,"translate"),t.nrm(16,"nz-badge",5),t.nI1(17,"translate"),t.k0s(),t.j41(18,"nz-descriptions-item",3),t.nI1(19,"translate"),t.j41(20,"a",6),t.EFF(21,"View"),t.k0s()()()),2&r){const n=s.ngIf,e=t.XpG().ngIf,o=t.XpG();t.FS9("nzTitle",t.bMT(1,15,"profile.driverInfo")+(e.submittedByRider?"":" (Sender)")),t.R7$(2),t.FS9("nzTitle",t.bMT(3,17,"profile.name")),t.R7$(2),t.Lme("",n.firstName," ",n.lastName,""),t.R7$(),t.FS9("nzTitle",t.bMT(6,19,"profile.mobileNumber")),t.R7$(2),t.Y8G("href","tel:"+n.mobileNumber,t.B4B),t.R7$(),t.JRh(t.bMT(9,21,n.mobileNumber)),t.R7$(2),t.FS9("nzTitle",t.bMT(11,23,"profile.registeredOn")),t.R7$(2),t.JRh(t.i5U(13,25,n.registrationTimestamp,"short")),t.R7$(2),t.FS9("nzTitle",t.bMT(15,28,"profile.status")),t.Y8G("nzSpan",2),t.R7$(2),t.Y8G("nzStatus",o.tagColor.driver(n.status))("nzText",t.bMT(17,30,"enum.driver.status."+o.camelCase(n.status))),t.R7$(2),t.FS9("nzTitle",t.bMT(19,32,"profile.view")),t.R7$(2),t.Y8G("routerLink","/../drivers/all/view/"+n.id)}}function w(r,s){if(1&r&&(t.j41(0,"nz-descriptions",2),t.nI1(1,"translate"),t.j41(2,"nz-descriptions-item",3),t.nI1(3,"translate"),t.EFF(4),t.k0s(),t.j41(5,"nz-descriptions-item",3),t.nI1(6,"translate"),t.j41(7,"a",19),t.EFF(8),t.nI1(9,"phone"),t.k0s()(),t.j41(10,"nz-descriptions-item",3),t.nI1(11,"translate"),t.EFF(12),t.nI1(13,"date"),t.k0s(),t.j41(14,"nz-descriptions-item",4),t.nI1(15,"translate"),t.nrm(16,"nz-badge",5),t.nI1(17,"translate"),t.k0s(),t.j41(18,"nz-descriptions-item",3),t.nI1(19,"translate"),t.j41(20,"a",6),t.EFF(21),t.nI1(22,"translate"),t.k0s()()()),2&r){const n=s.ngIf,e=t.XpG().ngIf,o=t.XpG();t.FS9("nzTitle",t.bMT(1,16,"profile.riderInfo")+(e.submittedByRider?"":" (Sender)")),t.R7$(2),t.FS9("nzTitle",t.bMT(3,18,"profile.name")),t.R7$(2),t.Lme("",n.firstName," ",n.lastName,""),t.R7$(),t.FS9("nzTitle",t.bMT(6,20,"profile.mobileNumber")),t.R7$(2),t.Y8G("href","tel:"+n.mobileNumber,t.B4B),t.R7$(),t.JRh(t.bMT(9,22,n.mobileNumber)),t.R7$(2),t.FS9("nzTitle",t.bMT(11,24,"profile.registeredOn")),t.R7$(2),t.JRh(null!==n.registrationTimestamp?t.i5U(13,26,n.registrationTimestamp,"short"):"-"),t.R7$(2),t.FS9("nzTitle",t.bMT(15,29,"profile.status")),t.Y8G("nzSpan",2),t.R7$(2),t.Y8G("nzStatus",o.tagColor.rider(n.status))("nzText",t.bMT(17,31,"enum.rider.status."+n.status.toLowerCase())),t.R7$(2),t.FS9("nzTitle",t.bMT(19,33,"profile.view")),t.R7$(2),t.Y8G("routerLink","/../riders/view/"+n.id),t.R7$(),t.JRh(t.bMT(22,35,"profile.view"))}}function H(r,s){if(1&r&&(t.j41(0,"tr")(1,"td")(2,"div",22)(3,"div")(4,"div",23),t.EFF(5),t.nI1(6,"translate"),t.k0s(),t.j41(7,"div",24),t.nI1(8,"date"),t.EFF(9),t.nI1(10,"timeago"),t.k0s()()()(),t.j41(11,"td"),t.EFF(12),t.k0s()()),2&r){const n=s.$implicit,e=t.XpG(2).ngIf,o=t.XpG();t.R7$(5),t.SpI(" ",t.bMT(6,6,"enum.sosActivityAction."+o.camelCase(n.action))," "),t.R7$(2),t.Y8G("nz-tooltip",t.i5U(8,8,n.createdAt,"short"))("routerLink",null!=n.operator?"/operators/view/"+n.operator.id:null),t.R7$(2),t.Lme(" ",t.bMT(10,11,n.createdAt)," by ",null==n.operator?e.submittedByRider?"Rider":"Driver":n.operator.firstName+" "+n.operator.lastName," "),t.R7$(3),t.JRh(n.note)}}function P(r,s){if(1&r&&(t.j41(0,"nz-table",20,0)(2,"thead")(3,"tr")(4,"th"),t.EFF(5,"Title"),t.k0s(),t.j41(6,"th"),t.EFF(7,"Note"),t.k0s()()(),t.j41(8,"tbody"),t.DNE(9,H,13,13,"tr",21),t.k0s()()),2&r){const n=s.ngIf,e=t.sdS(1);t.Y8G("nzShowPagination",!1)("nzData",n)("nzTotal",n.length),t.R7$(9),t.Y8G("ngForOf",e.data)}}function Q(r,s){if(1&r&&(t.nrm(0,"nz-option",15),t.nI1(1,"translate")),2&r){const n=t.XpG(2);t.Y8G("nzLabel",t.bMT(1,2,"enum.sosActivityAction.submitted"))("nzValue",n.activityAction.Submitted)}}function W(r,s){if(1&r&&(t.nrm(0,"nz-option",15),t.nI1(1,"translate")),2&r){const n=t.XpG(2);t.Y8G("nzLabel",t.bMT(1,2,"enum.sosActivityAction.seen"))("nzValue",n.activityAction.Seen)}}function Z(r,s){if(1&r){const n=t.RV6();t.j41(0,"div")(1,"nz-descriptions",2),t.nI1(2,"translate"),t.j41(3,"nz-descriptions-item",3),t.nI1(4,"translate"),t.EFF(5),t.nI1(6,"date"),t.k0s(),t.j41(7,"nz-descriptions-item",3),t.nI1(8,"translate"),t.EFF(9),t.nI1(10,"date"),t.k0s(),t.j41(11,"nz-descriptions-item",3),t.nI1(12,"translate"),t.EFF(13),t.nI1(14,"date"),t.k0s(),t.j41(15,"nz-descriptions-item",3),t.nI1(16,"translate"),t.EFF(17),t.nI1(18,"currency"),t.k0s(),t.j41(19,"nz-descriptions-item",3),t.nI1(20,"translate"),t.EFF(21),t.nI1(22,"currency"),t.k0s(),t.j41(23,"nz-descriptions-item",4),t.nI1(24,"translate"),t.nrm(25,"nz-badge",5),t.nI1(26,"translate"),t.k0s(),t.j41(27,"nz-descriptions-item",4),t.nI1(28,"translate"),t.EFF(29),t.k0s(),t.j41(30,"nz-descriptions-item",3),t.nI1(31,"translate"),t.j41(32,"a",6),t.EFF(33),t.nI1(34,"translate"),t.k0s()()(),t.DNE(35,D,22,34,"nz-descriptions",7)(36,w,23,37,"nz-descriptions",7)(37,P,10,4,"nz-table",8),t.j41(38,"nz-card",9)(39,"form",10),t.bIt("ngSubmit",function(){const o=t.eBV(n).ngIf,a=t.XpG();return t.Njj(a.onSubmitActivity(o.id))}),t.j41(40,"div",11)(41,"nz-form-item")(42,"nz-form-label",12),t.EFF(43,"Action"),t.k0s(),t.j41(44,"nz-form-control")(45,"nz-select",13),t.DNE(46,Q,2,4,"nz-option",14)(47,W,2,4,"nz-option",14),t.nrm(48,"nz-option",15),t.nI1(49,"translate"),t.nrm(50,"nz-option",15),t.nI1(51,"translate"),t.nrm(52,"nz-option",15),t.nI1(53,"translate"),t.nrm(54,"nz-option",15),t.nI1(55,"translate"),t.k0s()()(),t.j41(56,"nz-form-item")(57,"nz-form-label",16),t.EFF(58,"Note"),t.k0s(),t.j41(59,"nz-form-control"),t.nrm(60,"input",17),t.k0s()()(),t.j41(61,"button",18),t.EFF(62),t.nI1(63,"translate"),t.k0s()()()()}if(2&r){const n=s.ngIf,e=t.XpG();t.R7$(),t.FS9("nzTitle",t.bMT(2,37,"profile.requestInfo")),t.R7$(2),t.FS9("nzTitle",t.bMT(4,39,"requests.expectedTime")),t.R7$(2),t.JRh(null!==n.order.expectedTimestamp?t.i5U(6,41,n.order.expectedTimestamp,"short"):"-"),t.R7$(2),t.FS9("nzTitle",t.bMT(8,44,"requests.startTime")),t.R7$(2),t.JRh(null!==n.order.startTimestamp?t.i5U(10,46,n.order.startTimestamp,"short"):"-"),t.R7$(2),t.FS9("nzTitle",t.bMT(12,49,"requests.finishTime")),t.R7$(2),t.JRh(null!==n.order.finishTimestamp?t.i5U(14,51,n.order.finishTimestamp,"short"):"-"),t.R7$(2),t.FS9("nzTitle",t.bMT(16,54,"requests.costAfterCoupon")),t.R7$(2),t.JRh(t.i5U(18,56,n.order.costAfterCoupon,n.order.currency)),t.R7$(2),t.FS9("nzTitle",t.bMT(20,59,"requests.estimatedCost")),t.R7$(2),t.JRh(t.i5U(22,61,n.order.costBest,n.order.currency)),t.R7$(2),t.FS9("nzTitle",t.bMT(24,64,"profile.status")),t.Y8G("nzSpan",2),t.R7$(2),t.Y8G("nzStatus",e.tagColor.orderStatus(n.order.status))("nzText",t.bMT(26,66,"enum.request."+n.order.status)),t.R7$(2),t.FS9("nzTitle",t.bMT(28,68,"profile.locations")),t.Y8G("nzSpan",3),t.R7$(2),t.SpI(" ",n.order.addresses.join(" -> ")," "),t.R7$(),t.FS9("nzTitle",t.bMT(31,70,"profile.view")),t.R7$(2),t.Y8G("routerLink","/../requests/view/"+n.order.id),t.R7$(),t.JRh(t.bMT(34,72,"profile.view")),t.R7$(2),t.Y8G("ngIf",n.order.driver),t.R7$(),t.Y8G("ngIf",n.order.rider),t.R7$(),t.Y8G("ngIf",n.activities),t.R7$(2),t.Y8G("formGroup",e.formActivity),t.R7$(7),t.Y8G("ngIf",!1),t.R7$(),t.Y8G("ngIf",!1),t.R7$(),t.Y8G("nzLabel",t.bMT(49,74,"enum.sosActivityAction.contactDriver"))("nzValue",e.activityAction.ContactDriver),t.R7$(2),t.Y8G("nzLabel",t.bMT(51,76,"enum.sosActivityAction.contactAuthorities"))("nzValue",e.activityAction.ContactAuthorities),t.R7$(2),t.Y8G("nzLabel",t.bMT(53,78,"enum.sosActivityAction.markedAsResolved"))("nzValue",e.activityAction.MarkedAsResolved),t.R7$(2),t.Y8G("nzLabel",t.bMT(55,80,"enum.sosActivityAction.markedAsFalseAlarm"))("nzValue",e.activityAction.MarkedAsFalseAlarm),t.R7$(7),t.Y8G("disabled",!e.formActivity.valid),t.R7$(),t.JRh(t.bMT(63,82,"profile.submit"))}}let K=(()=>{class r{route;tagColor;fb;msg;addActivityGql;routerHelper;query;formActivity;camelCase=b.xQ;activityAction=d.zy9;activityActions=Object.values(d.zy9).filter(n=>n!=d.zy9.Seen&&n!=d.zy9.Submitted);constructor(n,e,o,a,g,et){this.route=n,this.tagColor=e,this.fb=o,this.msg=a,this.addActivityGql=g,this.routerHelper=et}ngOnInit(){this.query=this.route.parent?.data.pipe((0,I.T)(n=>n.sos)),this.formActivity=this.fb.group({action:[null,l.k0.required],note:[null]})}onSubmitActivity(n){var e=this;return(0,h.A)(function*(){try{yield(0,F._)(e.addActivityGql.mutate({activity:{...e.formActivity.value,sosId:n}})),e.msg.success("Activity recorded"),e.routerHelper.refresh(e.route),e.formActivity.patchValue({})}catch(o){e.msg.error(o.message)}})()}static \u0275fac=function(e){return new(e||r)(t.rXU(T.nX),t.rXU(R.t),t.rXU(l.ze),t.rXU($.xh),t.rXU(d.JRD),t.rXU(y.T))};static \u0275cmp=t.VBU({type:r,selectors:[["app-sos-view-info"]],standalone:!1,decls:2,vars:3,consts:[["activityTable",""],[4,"ngIf"],["nzBordered","",1,"mt-2",3,"nzTitle"],[3,"nzTitle"],[3,"nzTitle","nzSpan"],[3,"nzStatus","nzText"],[3,"routerLink"],["nzBordered","","class","mt-2",3,"nzTitle",4,"ngIf"],["nzTitle","Activities","nzBordered","","class","mt-2 mb-2",3,"nzShowPagination","nzData","nzTotal",4,"ngIf"],["nzTitle","Insert activity"],["nz-form","",3,"ngSubmit","formGroup"],[1,"lg:grid","lg:grid-cols-2","lg:gap-2"],["nzRequired",""],["formControlName","action"],[3,"nzLabel","nzValue",4,"ngIf"],[3,"nzLabel","nzValue"],["nzFor","note"],["nz-input","","formControlName","note","id","note","required","",1,"w-full"],["nz-button","","nzType","primary","type","submit",1,"float-right","mt-2",3,"disabled"],[3,"href"],["nzTitle","Activities","nzBordered","",1,"mt-2","mb-2",3,"nzShowPagination","nzData","nzTotal"],[4,"ngFor","ngForOf"],[1,"flex","items-center","ml-2"],[1,"text-sm","text-neutral-700","group-hover:text-neutral-900"],[1,"text-sm","text-neutral-400","group-hover:text-neutral-700",3,"nz-tooltip","routerLink"]],template:function(e,o){if(1&e&&(t.DNE(0,Z,64,84,"div",1),t.nI1(1,"async")),2&e){let a;t.Y8G("ngIf",null==(a=t.bMT(1,1,o.query))||null==a.data?null:a.data.distressSignal)}},dependencies:[u.Wk,c.Sq,c.bT,l.qT,l.me,l.BC,l.cb,l.YS,l.j4,l.JD,m.CP,m.SO,m._4,m.IL,m.aj,m.kt,O.Sy,L.aO,X.c,B.p,M.Uq,M.e,v.CA,v.Ls,v.Mo,v.zS,C.ld,C.WI,f.xA,f.gr,N.dz,G.cK,U.LH,c.Jj,c.oe,c.vh,J.X,A.D9,j.PZ],encapsulation:2})}return r})(),E=(()=>{class r{gql;constructor(n){this.gql=n}resolve(n,e){return this.gql.fetch({id:n.params.id})}static \u0275fac=function(e){return new(e||r)(t.KVO(d.lGS))};static \u0275prov=t.jDH({token:r,factory:r.\u0275fac})}return r})();const q=[{path:"",component:k,resolve:{sos:E},runGuardsAndResolvers:"paramsOrQueryParamsChange",children:[{path:"",redirectTo:"info",pathMatch:"full"},{path:"info",component:K}]}];let _=(()=>{class r{static \u0275fac=function(e){return new(e||r)};static \u0275mod=t.$C({type:r});static \u0275inj=t.G2t({providers:[E],imports:[u.iI.forChild(q),u.iI]})}return r})();var tt=i(5885);let nt=(()=>{class r{static \u0275fac=function(e){return new(e||r)};static \u0275mod=t.$C({type:r});static \u0275inj=t.G2t({imports:[_,tt.G]})}return r})()}}]);