"use strict";(self.webpackChunkadmin_panel=self.webpackChunkadmin_panel||[]).push([[425],{425:(S,b,i)=>{i.r(b),i.d(b,{RiderWalletsModule:()=>A});var h=i(8434),v=i(7624),T=i(467),y=i(3241),F=i(8204),f=i(6354),M=i(4843),t=i(6807),n=i(1360),d=i(2209),o=i(9417),r=i(3359),g=i(1011),s=i(1868),c=i(2602),m=i(513),$=i(6389),E=i(5930),D=i(1951),C=i(3062),W=i(8018);const O=()=>[];function G(l,j){if(1&l&&(n.j41(0,"tr")(1,"td"),n.EFF(2),n.k0s(),n.j41(3,"td"),n.EFF(4),n.nI1(5,"currency"),n.k0s(),n.j41(6,"td"),n.EFF(7),n.k0s(),n.j41(8,"td")(9,"a",22),n.EFF(10),n.nI1(11,"translate"),n.k0s()()()),2&l){const e=j.$implicit;n.R7$(2),n.JRh(null==e.rider?"Rider not found":e.rider.firstName+" "+e.rider.lastName),n.R7$(2),n.JRh(n.i5U(5,5,e.balance,e.currency)),n.R7$(3),n.JRh(e.currency),n.R7$(2),n.Y8G("routerLink","/riders/view/"+e.riderId),n.R7$(),n.JRh(n.bMT(11,8,"table.viewRider"))}}function x(l,j){if(1&l){const e=n.RV6();n.j41(0,"nz-table",16,2),n.bIt("nzQueryParams",function(u){n.eBV(e);const p=n.XpG(2);return n.Njj(p.tableService.onTableQueryParamsChange(u))}),n.j41(2,"thead")(3,"tr")(4,"th"),n.EFF(5),n.nI1(6,"translate"),n.k0s(),n.j41(7,"th",17),n.EFF(8),n.nI1(9,"translate"),n.j41(10,"nz-filter-trigger",18),n.nrm(11,"i",19),n.k0s()(),n.j41(12,"th",20),n.nI1(13,"async"),n.EFF(14),n.nI1(15,"translate"),n.k0s(),n.j41(16,"th"),n.EFF(17),n.nI1(18,"translate"),n.k0s()()(),n.j41(19,"tbody"),n.DNE(20,G,12,10,"tr",21),n.k0s()()}if(2&l){let e;const a=j.ngIf,u=n.sdS(1),p=n.XpG(2),z=n.sdS(15);n.Y8G("nzFrontPagination",!1)("nzData",a.nodes)("nzTotal",a.totalCount),n.R7$(5),n.JRh(n.bMT(6,12,"profile.name")),n.R7$(3),n.SpI("",n.bMT(9,14,"profile.amount")," "),n.R7$(2),n.Y8G("nzActive",-1!==p.amountRange[0])("nzDropdownMenu",z),n.R7$(2),n.Y8G("nzFilters",null!==(e=n.bMT(13,16,p.currencies))&&void 0!==e?e:n.lJ4(22,O))("nzFilterFn",!0),n.R7$(2),n.JRh(n.bMT(15,18,"profile.currency")),n.R7$(3),n.JRh(n.bMT(18,20,"profile.actions")),n.R7$(3),n.Y8G("ngForOf",u.data)}}function P(l,j){if(1&l&&(n.j41(0,"nz-page-header-content"),n.DNE(1,x,21,23,"nz-table",15),n.nI1(2,"async"),n.k0s()),2&l){let e;const a=n.XpG();n.R7$(),n.Y8G("ngIf",null==(e=n.bMT(2,1,a.query))||null==e.data?null:e.data.riderWallets)}}let _=(()=>{class l{route;tableService;exportGql;query;amountRange=[-1,-1];currencies;constructor(e,a,u){this.route=e,this.tableService=a,this.exportGql=u}ngOnInit(){this.query=this.route.data.pipe((0,f.T)(e=>e.riderWallet)),this.currencies=this.query.pipe((0,f.T)(e=>this.distinctCurrency(e.data.regions.nodes).map(a=>({text:a,value:a}))))}exportTo(e){var a=this;return(0,T.A)(function*(){const u=yield(0,M._)(a.exportGql.fetch({input:{table:y.Tln.RiderWallet,type:y.vYz.Csv,relations:["rider"]}}));a.tableService.downloadURI(F.c.root+u.data.export.url,`export-${(new Date).getTime()}.csv`)})()}distinctCurrency(e){return e.map(a=>a.currency).filter((a,u,p)=>p.indexOf(a)===u)}static \u0275fac=function(a){return new(a||l)(n.rXU(d.nX),n.rXU(t.a),n.rXU(y.dW1))};static \u0275cmp=n.VBU({type:l,selectors:[["app-rider-wallets"]],standalone:!1,decls:28,vars:22,consts:[["menuExport","nzDropdownMenu"],["filteramount","nzDropdownMenu"],["table",""],["nzBackIcon","","nzTitle","Rider Wallets","nzSubtitle","List of riders current wallet balance",3,"nzGhost"],["nz-button","","nz-dropdown","",3,"nzDropdownMenu"],["nz-icon","","nzType","export"],["nz-icon","","nzType","down"],["nz-menu",""],["nz-menu-item","",3,"click"],[4,"ngIf"],[1,"ant-table-filter-dropdown"],[1,"search-box"],["nz-input","","type","number",3,"ngModelChange","placeholder","ngModel"],["nz-button","","nzSize","small","nzType","primary",1,"search-button",3,"click"],["nz-button","","nzSize","small",3,"click"],["nzShowSizeChanger","","nzBordered","",3,"nzFrontPagination","nzData","nzTotal","nzQueryParams",4,"ngIf"],["nzShowSizeChanger","","nzBordered","",3,"nzQueryParams","nzFrontPagination","nzData","nzTotal"],["nzShowSort","","nzColumnKey","amount","nzCustomFilter",""],[3,"nzActive","nzDropdownMenu"],["nz-icon","","nzType","search"],["nzShowSort","","nzColumnKey","currency","nzShowFilter","",3,"nzFilters","nzFilterFn"],[4,"ngFor","ngForOf"],[3,"routerLink"]],template:function(a,u){if(1&a){const p=n.RV6();n.j41(0,"nz-page-header",3)(1,"nz-page-header-extra")(2,"button",4),n.nrm(3,"i",5),n.EFF(4),n.nI1(5,"translate"),n.nrm(6,"i",6),n.k0s(),n.j41(7,"nz-dropdown-menu",null,0)(9,"ul",7)(10,"li",8),n.bIt("click",function(){return n.eBV(p),n.Njj(u.exportTo("csv"))}),n.EFF(11,"CSV"),n.k0s()()()(),n.DNE(12,P,3,3,"nz-page-header-content",9),n.nI1(13,"async"),n.k0s(),n.j41(14,"nz-dropdown-menu",null,1)(16,"div",10)(17,"div",11)(18,"input",12),n.nI1(19,"translate"),n.mxI("ngModelChange",function(R){return n.eBV(p),n.DH7(u.amountRange[0],R)||(u.amountRange[0]=R),n.Njj(R)}),n.k0s(),n.j41(20,"input",12),n.nI1(21,"translate"),n.mxI("ngModelChange",function(R){return n.eBV(p),n.DH7(u.amountRange[1],R)||(u.amountRange[1]=R),n.Njj(R)}),n.k0s(),n.j41(22,"button",13),n.bIt("click",function(){return n.eBV(p),n.Njj(u.tableService.filterRange("balance",u.amountRange))}),n.EFF(23),n.nI1(24,"translate"),n.k0s(),n.j41(25,"button",14),n.bIt("click",function(){return n.eBV(p),n.Njj(u.tableService.filterRange("balance",void 0))}),n.EFF(26),n.nI1(27,"translate"),n.k0s()()()()}if(2&a){let p;const z=n.sdS(8);n.Y8G("nzGhost",!1),n.R7$(2),n.Y8G("nzDropdownMenu",z),n.R7$(2),n.SpI(" ",n.bMT(5,10,"profile.export")," "),n.R7$(8),n.Y8G("ngIf",null==(p=n.bMT(13,12,u.query))?null:p.data),n.R7$(6),n.FS9("placeholder",n.bMT(19,14,"table.min")),n.R50("ngModel",u.amountRange[0]),n.R7$(2),n.FS9("placeholder",n.bMT(21,16,"table.max")),n.R50("ngModel",u.amountRange[1]),n.R7$(3),n.JRh(n.bMT(24,18,"profile.search")),n.R7$(3),n.JRh(n.bMT(27,20,"profile.reset"))}},dependencies:[h.Sq,h.bT,v.Wk,o.me,o.Q0,o.BC,o.vS,r.CP,r.Cc,r.SO,r._4,r.IL,r.aj,r.kt,r.Kg,g.Sy,s.jS,s.CU,c.j3,c.wQ,c.h4,m.aO,$.c,E.p,D.Dn,C.WB,C.zR,C.ov,h.Jj,h.oe,W.D9],encapsulation:2})}return l})(),I=(()=>{class l{paging;gql;constructor(e,a){this.paging=e,this.gql=a}resolve(e,a){const u=this.paging.deserializeQueryParams(e.queryParams);return this.gql.fetch(u)}static \u0275fac=function(a){return new(a||l)(n.KVO(t.a),n.KVO(y.lOe))};static \u0275prov=n.jDH({token:l,factory:l.\u0275fac})}return l})();const L=[{path:"",component:_,resolve:{riderWallet:I},runGuardsAndResolvers:"paramsOrQueryParamsChange"}];let k=(()=>{class l{static \u0275fac=function(a){return new(a||l)};static \u0275mod=n.$C({type:l});static \u0275inj=n.G2t({providers:[I],imports:[v.iI.forChild(L),v.iI]})}return l})();var V=i(5885);let A=(()=>{class l{static \u0275fac=function(a){return new(a||l)};static \u0275mod=n.$C({type:l});static \u0275inj=n.G2t({imports:[h.MD,k,V.G]})}return l})()},6807:(S,b,i)=>{i.d(b,{a:()=>T});var h=i(1360),v=i(2209);let T=(()=>{class f{router;route;constructor(t,n){this.router=t,this.route=n}serializeQueryParams(t,n){const d={};if(d.pageIndex=t.pageIndex,d.pageSize=t.pageSize,null!=t.filter){const o=t.filter.filter(r=>null!=r.value&&r.value.length>0).map(r=>`${r.key}|${Array.isArray(r.value)?"in":"eq"}|${Array.isArray(r.value)?r.value.join("-"):r.value}`);null!=n.filter&&o.push(...n.filter.split(",")),d.filter=o.length>0?o.join(","):void 0}if(null!=t.sort&&t.sort.length>0){const o=t.sort.filter(r=>null!=r.value).map(r=>`${r.key}|${"ascend"==r.value?"ASC":"DESC"}`);null!=n.sort&&o.push(...n.sort.split(",")),d.sort=o.length>0?o.join(","):void 0}return d}onTableQueryParamsChange(t){const n=this.serializeQueryParams(t,this.route.snapshot.queryParams);this.router.navigate([],{relativeTo:this.route,queryParams:n,queryParamsHandling:"merge"})}filterText(t,n){const o=this.deserializeQueryParams(this.route).filter??{};o[t]=null!=n?{like:n}:{};const r=Object.keys(o).map(s=>{if(Object.keys(o[s]).length<1)return null;const c=Object.keys(o[s])[0];return`${s}|${c}|${"in"==c?o[s][c].join("-"):o[s][c]}`}).filter(s=>null!=s),g=r.length>0?r.join(","):void 0;this.router.navigate([],{relativeTo:this.route,queryParams:{filter:g},queryParamsHandling:"merge"})}filterRange(t,n){const o=this.deserializeQueryParams(this.route).filter??{};o[t]=null!=n?{between:n}:{};const r=Object.keys(o).map(s=>{if(Object.keys(o[s]).length<1)return null;const c=Object.keys(o[s])[0];return`${s}|${c}|${"in"==c||"between"==c?o[s][c].join("-"):o[s][c]}`}).filter(s=>null!=s),g=r.length>0?r.join(","):void 0;this.router.navigate([],{relativeTo:this.route,queryParams:{filter:g},queryParamsHandling:"merge"})}resetFilter(t,n){this.filterText(t,void 0),n.value=""}downloadURI(t,n){const d=document.createElement("a");d.download=n,d.href=t,d.target="_blank",document.body.appendChild(d),d.click(),document.body.removeChild(d)}deserializeQueryParams(t){const n=t.sort?t.sort.split(",").map(g=>({field:g.split("|")[0],direction:g.split("|")[1]})):[],d={};null!=t.filter&&t.filter.split(",").forEach(g=>{const s={},c=g.split("|")[1];if("in"==c){const m=g.split("|")[2].split("-");s[c]=m}else if("between"==c){const m=g.split("|")[2].split("-");s[c]={lower:m[0],upper:m[1]}}else s[c]=g.split("|")[2];d[g.split("|")[0]]=s});const o=null!=t.pageIndex?parseInt(t.pageIndex):1,r=null!=t.pageSize?parseInt(t.pageSize):10;return{sorting:n.length>0?n:void 0,paging:{offset:(o-1)*r,limit:r},filter:null!=d&&Object.keys(d).length>0?d:void 0}}static \u0275fac=function(n){return new(n||f)(h.KVO(v.Ix),h.KVO(v.nX))};static \u0275prov=h.jDH({token:f,factory:f.\u0275fac,providedIn:"root"})}return f})()}}]);