"use strict";(self.webpackChunkadmin_panel=self.webpackChunkadmin_panel||[]).push([[819],{1200:(S,b,o)=>{o.r(b),o.d(b,{FleetWalletsModule:()=>A});var F=o(5885),v=o(7624),R=o(467),y=o(3241),T=o(8204),g=o(6354),M=o(4843),t=o(6807),e=o(1360),c=o(2209),l=o(8434),s=o(9417),d=o(3359),u=o(1011),p=o(1868),m=o(2602),$=o(513),E=o(6389),D=o(5930),W=o(1951),C=o(3062),G=o(8018);const O=()=>[];function x(a,j){if(1&a&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.nI1(5,"currency"),e.k0s(),e.j41(6,"td"),e.EFF(7),e.k0s(),e.j41(8,"td")(9,"a",22),e.EFF(10),e.nI1(11,"translate"),e.k0s()()()),2&a){const n=j.$implicit;e.R7$(2),e.JRh(n.fleet.name),e.R7$(2),e.JRh(e.i5U(5,5,n.balance,n.currency)),e.R7$(3),e.JRh(n.currency),e.R7$(2),e.Y8G("routerLink","/management/fleets/view/"+n.fleetId),e.R7$(),e.JRh(e.bMT(11,8,"table.viewFleet"))}}function P(a,j){if(1&a){const n=e.RV6();e.j41(0,"nz-table",16,2),e.bIt("nzQueryParams",function(i){e.eBV(n);const f=e.XpG(2);return e.Njj(f.tableService.onTableQueryParamsChange(i))}),e.j41(2,"thead")(3,"tr")(4,"th"),e.EFF(5),e.nI1(6,"translate"),e.k0s(),e.j41(7,"th",17),e.EFF(8),e.nI1(9,"translate"),e.j41(10,"nz-filter-trigger",18),e.nrm(11,"i",19),e.k0s()(),e.j41(12,"th",20),e.nI1(13,"async"),e.EFF(14),e.nI1(15,"translate"),e.k0s(),e.j41(16,"th"),e.EFF(17),e.nI1(18,"translate"),e.k0s()()(),e.j41(19,"tbody"),e.DNE(20,x,12,10,"tr",21),e.k0s()()}if(2&a){let n;const r=j.ngIf,i=e.sdS(1),f=e.XpG(2),h=e.sdS(15);e.Y8G("nzFrontPagination",!1)("nzData",r.nodes)("nzTotal",r.totalCount),e.R7$(5),e.JRh(e.bMT(6,12,"profile.name")),e.R7$(3),e.SpI("",e.bMT(9,14,"profile.amount")," "),e.R7$(2),e.Y8G("nzActive",-1!==f.amountRange[0])("nzDropdownMenu",h),e.R7$(2),e.Y8G("nzFilters",null!==(n=e.bMT(13,16,f.currencies))&&void 0!==n?n:e.lJ4(22,O))("nzFilterFn",!0),e.R7$(2),e.JRh(e.bMT(15,18,"profile.currency")),e.R7$(3),e.JRh(e.bMT(18,20,"profile.actions")),e.R7$(3),e.Y8G("ngForOf",i.data)}}function _(a,j){if(1&a&&(e.j41(0,"nz-page-header-content"),e.DNE(1,P,21,23,"nz-table",15),e.nI1(2,"async"),e.k0s()),2&a){let n;const r=e.XpG();e.R7$(),e.Y8G("ngIf",null==(n=e.bMT(2,1,r.query))||null==n.data?null:n.data.fleetWallets)}}let L=(()=>{class a{route;tableService;exportGql;query;amountRange=[-1,-1];currencies;constructor(n,r,i){this.route=n,this.tableService=r,this.exportGql=i}ngOnInit(){this.query=this.route.data.pipe((0,g.T)(n=>n.fleetWallet)),this.currencies=this.query.pipe((0,g.T)(n=>this.distinctCurrency(n.data.regions.nodes).map(r=>({text:r,value:r}))))}exportTo(n){var r=this;return(0,R.A)(function*(){const i=yield(0,M._)(r.exportGql.fetch({input:{table:y.Tln.FleetWallet,type:y.vYz.Csv}}));r.tableService.downloadURI(T.c.root+i.data.export.url,`export-${(new Date).getTime()}.csv`)})()}distinctCurrency(n){return n.map(r=>r.currency).filter((r,i,f)=>f.indexOf(r)===i)}static \u0275fac=function(r){return new(r||a)(e.rXU(c.nX),e.rXU(t.a),e.rXU(y.dW1))};static \u0275cmp=e.VBU({type:a,selectors:[["app-fleet-wallets-list"]],standalone:!1,decls:28,vars:22,consts:[["menuExport","nzDropdownMenu"],["filteramount","nzDropdownMenu"],["table",""],["nzBackIcon","","nzTitle","Fleet Wallets","nzSubtitle","List of fleets current wallet balance",3,"nzGhost"],["nz-button","","nz-dropdown","",3,"nzDropdownMenu"],["nz-icon","","nzType","export"],["nz-icon","","nzType","down"],["nz-menu",""],["nz-menu-item","",3,"click"],[4,"ngIf"],[1,"ant-table-filter-dropdown"],[1,"search-box"],["nz-input","","type","number",3,"ngModelChange","placeholder","ngModel"],["nz-button","","nzSize","small","nzType","primary",1,"search-button",3,"click"],["nz-button","","nzSize","small",3,"click"],["nzShowSizeChanger","","nzBordered","",3,"nzFrontPagination","nzData","nzTotal","nzQueryParams",4,"ngIf"],["nzShowSizeChanger","","nzBordered","",3,"nzQueryParams","nzFrontPagination","nzData","nzTotal"],["nzShowSort","","nzColumnKey","amount","nzCustomFilter",""],[3,"nzActive","nzDropdownMenu"],["nz-icon","","nzType","search"],["nzShowSort","","nzColumnKey","currency","nzShowFilter","",3,"nzFilters","nzFilterFn"],[4,"ngFor","ngForOf"],[3,"routerLink"]],template:function(r,i){if(1&r){const f=e.RV6();e.j41(0,"nz-page-header",3)(1,"nz-page-header-extra")(2,"button",4),e.nrm(3,"i",5),e.EFF(4),e.nI1(5,"translate"),e.nrm(6,"i",6),e.k0s(),e.j41(7,"nz-dropdown-menu",null,0)(9,"ul",7)(10,"li",8),e.bIt("click",function(){return e.eBV(f),e.Njj(i.exportTo("csv"))}),e.EFF(11,"CSV"),e.k0s()()()(),e.DNE(12,_,3,3,"nz-page-header-content",9),e.nI1(13,"async"),e.k0s(),e.j41(14,"nz-dropdown-menu",null,1)(16,"div",10)(17,"div",11)(18,"input",12),e.nI1(19,"translate"),e.mxI("ngModelChange",function(z){return e.eBV(f),e.DH7(i.amountRange[0],z)||(i.amountRange[0]=z),e.Njj(z)}),e.k0s(),e.j41(20,"input",12),e.nI1(21,"translate"),e.mxI("ngModelChange",function(z){return e.eBV(f),e.DH7(i.amountRange[1],z)||(i.amountRange[1]=z),e.Njj(z)}),e.k0s(),e.j41(22,"button",13),e.bIt("click",function(){return e.eBV(f),e.Njj(i.tableService.filterRange("balance",i.amountRange))}),e.EFF(23),e.nI1(24,"translate"),e.k0s(),e.j41(25,"button",14),e.bIt("click",function(){return e.eBV(f),e.Njj(i.tableService.filterRange("balance",void 0))}),e.EFF(26),e.nI1(27,"translate"),e.k0s()()()()}if(2&r){let f;const h=e.sdS(8);e.Y8G("nzGhost",!1),e.R7$(2),e.Y8G("nzDropdownMenu",h),e.R7$(2),e.SpI(" ",e.bMT(5,10,"profile.export")," "),e.R7$(8),e.Y8G("ngIf",null==(f=e.bMT(13,12,i.query))?null:f.data),e.R7$(6),e.FS9("placeholder",e.bMT(19,14,"table.min")),e.R50("ngModel",i.amountRange[0]),e.R7$(2),e.FS9("placeholder",e.bMT(21,16,"table.max")),e.R50("ngModel",i.amountRange[1]),e.R7$(3),e.JRh(e.bMT(24,18,"profile.search")),e.R7$(3),e.JRh(e.bMT(27,20,"profile.reset"))}},dependencies:[v.Wk,l.Sq,l.bT,s.me,s.Q0,s.BC,s.vS,d.CP,d.Cc,d.SO,d._4,d.IL,d.aj,d.kt,d.Kg,u.Sy,p.jS,p.CU,m.j3,m.wQ,m.h4,$.aO,E.c,D.p,W.Dn,C.WB,C.zR,C.ov,l.Jj,l.oe,G.D9],encapsulation:2})}return a})(),I=(()=>{class a{paging;gql;constructor(n,r){this.paging=n,this.gql=r}resolve(n,r){const i=this.paging.deserializeQueryParams(n.queryParams);return this.gql.fetch(i)}static \u0275fac=function(r){return new(r||a)(e.KVO(t.a),e.KVO(y.v1H))};static \u0275prov=e.jDH({token:a,factory:a.\u0275fac})}return a})();const k=[{path:"",component:L,resolve:{fleetWallet:I},runGuardsAndResolvers:"paramsOrQueryParamsChange"}];let V=(()=>{class a{static \u0275fac=function(r){return new(r||a)};static \u0275mod=e.$C({type:a});static \u0275inj=e.G2t({providers:[I],imports:[v.iI.forChild(k),v.iI]})}return a})(),A=(()=>{class a{static \u0275fac=function(r){return new(r||a)};static \u0275mod=e.$C({type:a});static \u0275inj=e.G2t({imports:[V,F.G]})}return a})()},6807:(S,b,o)=>{o.d(b,{a:()=>R});var F=o(1360),v=o(2209);let R=(()=>{class g{router;route;constructor(t,e){this.router=t,this.route=e}serializeQueryParams(t,e){const c={};if(c.pageIndex=t.pageIndex,c.pageSize=t.pageSize,null!=t.filter){const l=t.filter.filter(s=>null!=s.value&&s.value.length>0).map(s=>`${s.key}|${Array.isArray(s.value)?"in":"eq"}|${Array.isArray(s.value)?s.value.join("-"):s.value}`);null!=e.filter&&l.push(...e.filter.split(",")),c.filter=l.length>0?l.join(","):void 0}if(null!=t.sort&&t.sort.length>0){const l=t.sort.filter(s=>null!=s.value).map(s=>`${s.key}|${"ascend"==s.value?"ASC":"DESC"}`);null!=e.sort&&l.push(...e.sort.split(",")),c.sort=l.length>0?l.join(","):void 0}return c}onTableQueryParamsChange(t){const e=this.serializeQueryParams(t,this.route.snapshot.queryParams);this.router.navigate([],{relativeTo:this.route,queryParams:e,queryParamsHandling:"merge"})}filterText(t,e){const l=this.deserializeQueryParams(this.route).filter??{};l[t]=null!=e?{like:e}:{};const s=Object.keys(l).map(u=>{if(Object.keys(l[u]).length<1)return null;const p=Object.keys(l[u])[0];return`${u}|${p}|${"in"==p?l[u][p].join("-"):l[u][p]}`}).filter(u=>null!=u),d=s.length>0?s.join(","):void 0;this.router.navigate([],{relativeTo:this.route,queryParams:{filter:d},queryParamsHandling:"merge"})}filterRange(t,e){const l=this.deserializeQueryParams(this.route).filter??{};l[t]=null!=e?{between:e}:{};const s=Object.keys(l).map(u=>{if(Object.keys(l[u]).length<1)return null;const p=Object.keys(l[u])[0];return`${u}|${p}|${"in"==p||"between"==p?l[u][p].join("-"):l[u][p]}`}).filter(u=>null!=u),d=s.length>0?s.join(","):void 0;this.router.navigate([],{relativeTo:this.route,queryParams:{filter:d},queryParamsHandling:"merge"})}resetFilter(t,e){this.filterText(t,void 0),e.value=""}downloadURI(t,e){const c=document.createElement("a");c.download=e,c.href=t,c.target="_blank",document.body.appendChild(c),c.click(),document.body.removeChild(c)}deserializeQueryParams(t){const e=t.sort?t.sort.split(",").map(d=>({field:d.split("|")[0],direction:d.split("|")[1]})):[],c={};null!=t.filter&&t.filter.split(",").forEach(d=>{const u={},p=d.split("|")[1];if("in"==p){const m=d.split("|")[2].split("-");u[p]=m}else if("between"==p){const m=d.split("|")[2].split("-");u[p]={lower:m[0],upper:m[1]}}else u[p]=d.split("|")[2];c[d.split("|")[0]]=u});const l=null!=t.pageIndex?parseInt(t.pageIndex):1,s=null!=t.pageSize?parseInt(t.pageSize):10;return{sorting:e.length>0?e:void 0,paging:{offset:(l-1)*s,limit:s},filter:null!=c&&Object.keys(c).length>0?c:void 0}}static \u0275fac=function(e){return new(e||g)(F.KVO(v.Ix),F.KVO(v.nX))};static \u0275prov=F.jDH({token:g,factory:g.\u0275fac,providedIn:"root"})}return g})()}}]);