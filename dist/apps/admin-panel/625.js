"use strict";(self.webpackChunkadmin_panel=self.webpackChunkadmin_panel||[]).push([[625],{625:(M,F,r)=>{r.r(F),r.d(F,{CouponsModule:()=>Z});var z=r(8434),v=r(7624),j=r(6807),G=r(2067),k=r(6354),n=r(1360),U=r(2209),o=r(3359),l=r(513),m=r(6389),a=r(5930),u=r(1951),f=r(5699),s=r(3062),c=r(8018);function g(e,C){if(1&e&&(n.j41(0,"tr",8)(1,"td")(2,"div")(3,"div",9),n.EFF(4),n.k0s(),n.j41(5,"div",10),n.EFF(6),n.k0s()()(),n.j41(7,"td"),n.EFF(8),n.k0s(),n.j41(9,"td"),n.EFF(10),n.nI1(11,"date"),n.nI1(12,"date"),n.k0s(),n.j41(13,"td",11)(14,"nz-tag",12),n.EFF(15),n.nI1(16,"translate"),n.nI1(17,"translate"),n.k0s()()()),2&e){const t=C.$implicit,i=n.XpG(2);n.Y8G("routerLink","view/"+t.id),n.R7$(4),n.SpI(" ",t.title," "),n.R7$(2),n.SpI(" ",t.description," "),n.R7$(2),n.JRh(t.code),n.R7$(2),n.Lme("",n.i5U(11,9,t.startAt,"mediumDate")," - ",n.i5U(12,12,t.expireAt,"mediumDate"),""),n.R7$(4),n.Y8G("nzColor",i.tagColor.boolean(t.isEnabled))("nzBordered",!1),n.R7$(),n.JRh(t.isEnabled?n.bMT(16,15,"profile.enabled"):n.bMT(17,17,"profile.disabled"))}}function A(e,C){if(1&e){const t=n.RV6();n.j41(0,"nz-table",5,0),n.bIt("nzQueryParams",function(p){n.eBV(t);const h=n.XpG();return n.Njj(h.tableService.onTableQueryParamsChange(p))}),n.j41(2,"thead")(3,"tr")(4,"th"),n.EFF(5),n.nI1(6,"translate"),n.k0s(),n.j41(7,"th"),n.EFF(8),n.nI1(9,"translate"),n.k0s(),n.j41(10,"th"),n.EFF(11),n.nI1(12,"translate"),n.k0s(),n.j41(13,"th",6),n.EFF(14),n.nI1(15,"translate"),n.k0s()()(),n.j41(16,"tbody"),n.DNE(17,g,18,19,"tr",7),n.k0s()()}if(2&e){const t=C.ngIf,i=n.sdS(1);n.Y8G("nzFrontPagination",!1)("nzData",t.nodes)("nzTotal",t.totalCount),n.R7$(5),n.JRh(n.bMT(6,8,"profile.title")),n.R7$(3),n.JRh(n.bMT(9,10,"profile.code")),n.R7$(3),n.JRh(n.bMT(12,12,"profile.dateTime")),n.R7$(3),n.JRh(n.bMT(15,14,"profile.status")),n.R7$(3),n.Y8G("ngForOf",i.data)}}let N=(()=>{class e{route;tableService;tagColor;query;constructor(t,i,p){this.route=t,this.tableService=i,this.tagColor=p}ngOnInit(){this.query=this.route.data.pipe((0,k.T)(t=>t.coupons))}static \u0275fac=function(i){return new(i||e)(n.rXU(U.nX),n.rXU(j.a),n.rXU(G.t))};static \u0275cmp=n.VBU({type:e,selectors:[["app-coupons-list"]],standalone:!1,decls:9,vars:7,consts:[["table",""],["nzBackIcon","","nzTitle","Coupons","nzSubtitle","List of all the coupons",3,"nzGhost"],["nz-button","","nzType","primary","routerLink","new"],["nz-icon","","nzType","plus"],["nzShowSizeChanger","","nzBordered","",3,"nzFrontPagination","nzData","nzTotal","nzQueryParams",4,"ngIf"],["nzShowSizeChanger","","nzBordered","",3,"nzQueryParams","nzFrontPagination","nzData","nzTotal"],["nzShowSort","","nzColumnKey","isEnabled",1,"hidden","lg:table-cell"],["class","group cursor-pointer",3,"routerLink",4,"ngFor","ngForOf"],[1,"group","cursor-pointer",3,"routerLink"],[1,"table-first-line"],[1,"table-second-line"],[1,"hidden","lg:table-cell"],[3,"nzColor","nzBordered"]],template:function(i,p){if(1&i&&(n.j41(0,"nz-page-header",1)(1,"nz-page-header-extra")(2,"button",2),n.nrm(3,"i",3),n.EFF(4),n.nI1(5,"translate"),n.k0s()(),n.j41(6,"nz-page-header-content"),n.DNE(7,A,18,16,"nz-table",4),n.nI1(8,"async"),n.k0s()()),2&i){let h;n.Y8G("nzGhost",!1),n.R7$(4),n.JRh(n.bMT(5,3,"profile.add")),n.R7$(3),n.Y8G("ngIf",null==(h=n.bMT(8,5,p.query))||null==h.data?null:h.data.coupons)}},dependencies:[z.Sq,z.bT,v.Wk,o.CP,o.Cc,o.SO,o._4,o.IL,o.aj,o.kt,l.aO,m.c,a.p,u.Dn,f.s,s.WB,s.zR,s.ov,z.Jj,z.vh,c.D9],encapsulation:2})}return e})();var S=r(467),d=r(9417),b=r(3241),R=r(4843),Q=r(7094),V=r(712),X=r(1011),$=r(7529),y=r(8927),O=r(8960),B=r(2047),J=r(7481),D=r(7685);function Y(e,C){if(1&e){const t=n.RV6();n.j41(0,"button",32),n.bIt("click",function(){n.eBV(t);const p=n.XpG(2);return n.Njj(p.deleteCoupon())}),n.EFF(1),n.nI1(2,"translate"),n.k0s()}2&e&&(n.R7$(),n.JRh(n.bMT(2,1,"profile.delete")))}function H(e,C){if(1&e&&(n.j41(0,"div"),n.DNE(1,Y,3,3,"button",31),n.k0s()),2&e){const t=n.XpG();n.R7$(),n.Y8G("ngIf",null!=t.form.value.id)}}function q(e,C){if(1&e&&(n.j41(0,"button",33),n.EFF(1),n.nI1(2,"translate"),n.k0s()),2&e){const t=n.XpG();n.Y8G("disabled",t.form.invalid),n.R7$(),n.JRh(n.bMT(2,2,"profile.saveChanges"))}}let P=(()=>{class e{route;message;fb;routerHelper;createGQL;updateGQL;deleteGQL;form;constructor(t,i,p,h,I,E,T){this.route=t,this.message=i,this.fb=p,this.routerHelper=h,this.createGQL=I,this.updateGQL=E,this.deleteGQL=T,this.form=this.fb.group({id:[null],code:[null,d.k0.required],title:[null,d.k0.required],description:[null,d.k0.required],manyUsersCanUse:[0,d.k0.required],manyTimesUserCanUse:[0,d.k0.required],minimumCost:[0,d.k0.required],maximumCost:[0,d.k0.required],dates:[null,d.k0.required],discountPercent:[0,d.k0.required],discountFlat:[0,d.k0.required],creditGift:[0,d.k0.required],isEnabled:[!0,d.k0.required],isFirstTravelOnly:[!1,d.k0.required]})}ngOnInit(){this.route.data.subscribe(t=>{null!=t.coupon&&(t.coupon.data.coupon.dates=[t.coupon.data.coupon.startAt,t.coupon.data.coupon.expireAt],this.form.patchValue(t.coupon.data.coupon))})}onSubmit(){var t=this;return(0,S.A)(function*(){const{id:i,dates:p,...h}=t.form.value,T={...h,startAt:p[0].getTime(),expireAt:p[1].getTime()};try{null==i?yield(0,R._)(t.createGQL.mutate({input:T})):yield(0,R._)(t.updateGQL.mutate({id:i,input:T})),t.routerHelper.goToParent(t.route)}catch(_){t.message.error(_.message)}})()}deleteCoupon(){var t=this;return(0,S.A)(function*(){yield(0,R._)(t.deleteGQL.mutate({id:t.form.value.id})),t.routerHelper.goToParent(t.route)})()}static \u0275fac=function(i){return new(i||e)(n.rXU(U.nX),n.rXU(Q.xh),n.rXU(d.ze),n.rXU(V.T),n.rXU(b.v1R),n.rXU(b.eLT),n.rXU(b.mqY))};static \u0275cmp=n.VBU({type:e,selectors:[["app-coupon-view"]],standalone:!1,decls:77,vars:11,consts:[["nz-form","","nzLayout","vertical",3,"ngSubmit","formGroup"],["nzBackIcon","",3,"nzGhost","nzTitle","nzSubtitle"],[4,"nzSpaceItem"],["nz-button","","nzType","primary","type","submit",3,"disabled",4,"nzSpaceItem"],["formControlName","id","type","hidden","hidden",""],[1,"lg:grid","lg:grid-cols-4","lg:gap-2"],["nzRequired","","nzFor","title"],["nz-input","","formControlName","title","id","title"],["nzRequired","","nzFor","code"],["nz-input","","formControlName","code","id","code"],["nzRequired","","nzFor","description"],["nz-input","","formControlName","description","id","description"],["nzRequired","","nzFor","manyUsersCanUse"],["formControlName","manyUsersCanUse","id","manyUsersCanUse"],["nzRequired","","nzFor","manyTimesUserCanUse"],["formControlName","manyTimesUserCanUse","id","manyTimesUserCanUse"],["nzRequired","","nzFor","minimumCost"],["formControlName","minimumCost","id","minimumCost"],["nzRequired","","nzFor","maximumCost"],["formControlName","maximumCost","id","maximumCost"],["id","dates","formControlName","dates",1,"w-full"],["nzRequired","","nzFor","discountPercent"],["formControlName","discountPercent","id","discountPercent"],["nzRequired","","nzFor","discountFlat"],["formControlName","discountFlat","id","discountFlat"],["nzRequired","","nzFor","creditGift"],["formControlName","creditGift","id","creditGift"],["nzFor","isEnabled"],["formControlName","isEnabled","id","isEnabled"],["nzFor","isFirstTravelOnly"],["formControlName","isFirstTravelOnly","id","isFirstTravelOnly"],["nz-button","","nzDanger","",3,"click",4,"ngIf"],["nz-button","","nzDanger","",3,"click"],["nz-button","","nzType","primary","type","submit",3,"disabled"]],template:function(i,p){1&i&&(n.j41(0,"form",0),n.bIt("ngSubmit",function(){return p.onSubmit()}),n.j41(1,"nz-page-header",1),n.nI1(2,"translate"),n.nI1(3,"translate"),n.j41(4,"nz-page-header-extra")(5,"nz-space"),n.DNE(6,H,2,1,"div",2)(7,q,3,4,"button",3),n.k0s()(),n.j41(8,"nz-page-header-content"),n.nrm(9,"input",4),n.j41(10,"div",5)(11,"nz-form-item")(12,"nz-form-label",6),n.EFF(13,"Title"),n.k0s(),n.j41(14,"nz-form-control"),n.nrm(15,"input",7),n.k0s()(),n.j41(16,"nz-form-item")(17,"nz-form-label",8),n.EFF(18,"Code"),n.k0s(),n.j41(19,"nz-form-control"),n.nrm(20,"input",9),n.k0s()(),n.j41(21,"nz-form-item")(22,"nz-form-label",10),n.EFF(23,"Description"),n.k0s(),n.j41(24,"nz-form-control"),n.nrm(25,"input",11),n.k0s()(),n.j41(26,"nz-form-item")(27,"nz-form-label",12),n.EFF(28,"# Users can use"),n.k0s(),n.j41(29,"nz-form-control"),n.nrm(30,"nz-input-number",13),n.k0s()(),n.j41(31,"nz-form-item")(32,"nz-form-label",14),n.EFF(33,"# Times User Can Use"),n.k0s(),n.j41(34,"nz-form-control"),n.nrm(35,"nz-input-number",15),n.k0s()(),n.j41(36,"nz-form-item")(37,"nz-form-label",16),n.EFF(38,"Minimum Cost"),n.k0s(),n.j41(39,"nz-form-control"),n.nrm(40,"nz-input-number",17),n.k0s()(),n.j41(41,"nz-form-item")(42,"nz-form-label",18),n.EFF(43,"Maximum Cost"),n.k0s(),n.j41(44,"nz-form-control"),n.nrm(45,"nz-input-number",19),n.k0s()(),n.j41(46,"nz-form-item")(47,"nz-form-label",18),n.EFF(48),n.nI1(49,"translate"),n.k0s(),n.j41(50,"nz-form-control"),n.nrm(51,"nz-range-picker",20),n.k0s()(),n.j41(52,"nz-form-item")(53,"nz-form-label",21),n.EFF(54,"Discount Percent"),n.k0s(),n.j41(55,"nz-form-control"),n.nrm(56,"nz-input-number",22),n.k0s()(),n.j41(57,"nz-form-item")(58,"nz-form-label",23),n.EFF(59,"Discount Flat"),n.k0s(),n.j41(60,"nz-form-control"),n.nrm(61,"nz-input-number",24),n.k0s()(),n.j41(62,"nz-form-item")(63,"nz-form-label",25),n.EFF(64,"Credit Gift"),n.k0s(),n.j41(65,"nz-form-control"),n.nrm(66,"nz-input-number",26),n.k0s()(),n.j41(67,"nz-form-item")(68,"nz-form-label",27),n.EFF(69,"Is Enabled?"),n.k0s(),n.j41(70,"nz-form-control"),n.nrm(71,"nz-switch",28),n.k0s()(),n.j41(72,"nz-form-item")(73,"nz-form-label",29),n.EFF(74,"Is First Travel Only?"),n.k0s(),n.j41(75,"nz-form-control"),n.nrm(76,"nz-switch",30),n.k0s()()()()()()),2&i&&(n.Y8G("formGroup",p.form),n.R7$(),n.Y8G("nzGhost",!1)("nzTitle",n.bMT(2,5,"menu.marketing.coupons"))("nzSubtitle",n.bMT(3,7,"coupons.description")),n.R7$(47),n.JRh(n.bMT(49,9,"coupons.availabilityTime")))},dependencies:[z.bT,d.qT,d.me,d.BC,d.cb,d.j4,d.JD,X.Sy,l.aO,m.c,a.p,$.Uq,$.e,y.CA,y.Ls,y.Mo,y.zS,O.SN,O.vw,s.WB,s.zR,s.ov,B.F,J.u,D.U5,D.Dq,c.D9],styles:["nz-input-number[_ngcontent-%COMP%]{width:100%}"]})}return e})(),L=(()=>{class e{paging;gql;constructor(t,i){this.paging=t,this.gql=i}resolve(t,i){const p=this.paging.deserializeQueryParams(t.queryParams);return this.gql.fetch(p)}static \u0275fac=function(i){return new(i||e)(n.KVO(j.a),n.KVO(b.jN$))};static \u0275prov=n.jDH({token:e,factory:e.\u0275fac})}return e})(),x=(()=>{class e{gql;constructor(t){this.gql=t}resolve(t,i){return this.gql.fetch({id:t.params.id})}static \u0275fac=function(i){return new(i||e)(n.KVO(b.soo))};static \u0275prov=n.jDH({token:e,factory:e.\u0275fac})}return e})();const K=[{path:"",component:N,resolve:{coupons:L},runGuardsAndResolvers:"paramsOrQueryParamsChange"},{path:"view/:id",component:P,resolve:{coupon:x}},{path:"new",component:P}];let w=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=n.$C({type:e});static \u0275inj=n.G2t({providers:[L,x],imports:[v.iI.forChild(K),v.iI]})}return e})();var W=r(5885);let Z=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=n.$C({type:e});static \u0275inj=n.G2t({imports:[z.MD,w,W.G]})}return e})()},6807:(M,F,r)=>{r.d(F,{a:()=>j});var z=r(1360),v=r(2209);let j=(()=>{class n{router;route;constructor(o,l){this.router=o,this.route=l}serializeQueryParams(o,l){const m={};if(m.pageIndex=o.pageIndex,m.pageSize=o.pageSize,null!=o.filter){const a=o.filter.filter(u=>null!=u.value&&u.value.length>0).map(u=>`${u.key}|${Array.isArray(u.value)?"in":"eq"}|${Array.isArray(u.value)?u.value.join("-"):u.value}`);null!=l.filter&&a.push(...l.filter.split(",")),m.filter=a.length>0?a.join(","):void 0}if(null!=o.sort&&o.sort.length>0){const a=o.sort.filter(u=>null!=u.value).map(u=>`${u.key}|${"ascend"==u.value?"ASC":"DESC"}`);null!=l.sort&&a.push(...l.sort.split(",")),m.sort=a.length>0?a.join(","):void 0}return m}onTableQueryParamsChange(o){const l=this.serializeQueryParams(o,this.route.snapshot.queryParams);this.router.navigate([],{relativeTo:this.route,queryParams:l,queryParamsHandling:"merge"})}filterText(o,l){const a=this.deserializeQueryParams(this.route).filter??{};a[o]=null!=l?{like:l}:{};const u=Object.keys(a).map(s=>{if(Object.keys(a[s]).length<1)return null;const c=Object.keys(a[s])[0];return`${s}|${c}|${"in"==c?a[s][c].join("-"):a[s][c]}`}).filter(s=>null!=s),f=u.length>0?u.join(","):void 0;this.router.navigate([],{relativeTo:this.route,queryParams:{filter:f},queryParamsHandling:"merge"})}filterRange(o,l){const a=this.deserializeQueryParams(this.route).filter??{};a[o]=null!=l?{between:l}:{};const u=Object.keys(a).map(s=>{if(Object.keys(a[s]).length<1)return null;const c=Object.keys(a[s])[0];return`${s}|${c}|${"in"==c||"between"==c?a[s][c].join("-"):a[s][c]}`}).filter(s=>null!=s),f=u.length>0?u.join(","):void 0;this.router.navigate([],{relativeTo:this.route,queryParams:{filter:f},queryParamsHandling:"merge"})}resetFilter(o,l){this.filterText(o,void 0),l.value=""}downloadURI(o,l){const m=document.createElement("a");m.download=l,m.href=o,m.target="_blank",document.body.appendChild(m),m.click(),document.body.removeChild(m)}deserializeQueryParams(o){const l=o.sort?o.sort.split(",").map(f=>({field:f.split("|")[0],direction:f.split("|")[1]})):[],m={};null!=o.filter&&o.filter.split(",").forEach(f=>{const s={},c=f.split("|")[1];if("in"==c){const g=f.split("|")[2].split("-");s[c]=g}else if("between"==c){const g=f.split("|")[2].split("-");s[c]={lower:g[0],upper:g[1]}}else s[c]=f.split("|")[2];m[f.split("|")[0]]=s});const a=null!=o.pageIndex?parseInt(o.pageIndex):1,u=null!=o.pageSize?parseInt(o.pageSize):10;return{sorting:l.length>0?l:void 0,paging:{offset:(a-1)*u,limit:u},filter:null!=m&&Object.keys(m).length>0?m:void 0}}static \u0275fac=function(l){return new(l||n)(z.KVO(v.Ix),z.KVO(v.nX))};static \u0275prov=z.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})()}}]);