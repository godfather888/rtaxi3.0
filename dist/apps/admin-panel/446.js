"use strict";(self.webpackChunkadmin_panel=self.webpackChunkadmin_panel||[]).push([[446],{6446:(P,F,i)=>{i.r(F),i.d(F,{ManagementRolesModule:()=>N});var R=i(5885),C=i(7624),T=i(467),z=i(9417),v=i(3241),m=i(4843),t=i(1360),o=i(2209),a=i(712),c=i(8434),s=i(1011),l=i(513),f=i(6389),u=i(5930),p=i(7529),g=i(8927),$=i(3062),V=i(5703),D=i(2986),S=i(8018);function E(r,y){if(1&r){const e=t.RV6();t.j41(0,"label",10),t.bIt("nzCheckedChange",function(d){const h=t.eBV(e).$implicit,j=t.XpG().$implicit,J=t.XpG();return t.Njj(J.onPermissionCheckChanged(j,h,d))}),t.EFF(1),t.k0s()}if(2&r){const e=y.$implicit,n=t.XpG().$implicit,d=t.XpG();t.Y8G("nzChecked",d.isPermissionChecked(n,e)),t.R7$(),t.JRh(e)}}function L(r,y){if(1&r&&(t.j41(0,"div",8)(1,"h6"),t.EFF(2),t.k0s(),t.DNE(3,E,2,2,"label",9),t.k0s()),2&r){const e=y.$implicit,n=t.XpG();t.R7$(2),t.JRh(e),t.R7$(),t.Y8G("ngForOf",n.getCategoryPermissions(e))}}let G=(()=>{class r{route;fb;updateGQL;createGQL;routerHelper;form;subscription;constructor(e,n,d,h,j){this.route=e,this.fb=n,this.updateGQL=d,this.createGQL=h,this.routerHelper=j}ngOnInit(){this.subscription=this.route.data.subscribe(e=>{null!=e.role&&this.form.patchValue(e.role.data.operatorRole)}),this.form=this.fb.group({id:[null],title:[null,z.k0.required],permissions:[[],z.k0.required]})}getPermissionsCategories(){const e=Object.values(v.SZN).map(n=>n.split("_")[0]);return[...new Set(e)]}getCategoryPermissions(e){return Object.values(v.SZN).filter(n=>n.startsWith(e+"_")).map(n=>n.split("_")[1])}ngOnDestroy(){this.subscription?.unsubscribe()}onSubmit(){var e=this;return(0,T.A)(function*(){const{id:n,...d}=e.form.value;null==n?yield(0,m._)(e.createGQL.mutate({input:d})):yield(0,m._)(e.updateGQL.mutate({id:n,input:d})),e.routerHelper.goToParent(e.route)})()}onPermissionCheckChanged(e,n,d){if(!this.form.value.permissions.includes(`${e}_${n}`)&&d&&(this.form.value.permissions.push(`${e}_${n}`),this.form.patchValue({permissions:this.form.value.permissions})),!d){const h=JSON.parse(JSON.stringify(this.form.value.permissions)).filter(j=>j!=`${e}_${n}`);this.form.patchValue({permissions:h})}}isPermissionChecked(e,n){return this.form.value.permissions.includes(`${e}_${n}`)}static \u0275fac=function(n){return new(n||r)(t.rXU(o.nX),t.rXU(z.ze),t.rXU(v.O2H),t.rXU(v.VvG),t.rXU(a.T))};static \u0275cmp=t.VBU({type:r,selectors:[["app-role-view"]],standalone:!1,decls:16,vars:7,consts:[["nzBackIcon","","nzTitle","User Role","nzSubtitle","Admin Panel user role definition",3,"nzGhost"],["nz-form","","nzLayout","vertical",3,"ngSubmit","formGroup"],["formControlName","id","type","hidden","hidden",""],[1,"lg:grid","lg:grid-cols-3","lg:gap-2"],["nzRequired","","nzFor","title"],["nz-input","","required","","id","title","formControlName","title"],["class","lg:grid lg:grid-cols-5 lg:gap-2 pt-2",4,"ngFor","ngForOf"],["nz-button","","nzType","primary","type","submit",1,"mt-2","float-right",3,"disabled"],[1,"lg:grid","lg:grid-cols-5","lg:gap-2","pt-2"],["nz-checkbox","",3,"nzChecked","nzCheckedChange",4,"ngFor","ngForOf"],["nz-checkbox","",3,"nzCheckedChange","nzChecked"]],template:function(n,d){1&n&&(t.nrm(0,"nz-page-header",0),t.j41(1,"nz-card")(2,"form",1),t.bIt("ngSubmit",function(){return d.onSubmit()}),t.nrm(3,"input",2),t.j41(4,"div",3)(5,"nz-form-item")(6,"nz-form-label",4),t.EFF(7,"Title"),t.k0s(),t.j41(8,"nz-form-control"),t.nrm(9,"input",5),t.k0s()()(),t.j41(10,"h4"),t.EFF(11,"Permissions"),t.k0s(),t.DNE(12,L,4,2,"div",6),t.j41(13,"button",7),t.EFF(14),t.nI1(15,"translate"),t.k0s()()()),2&n&&(t.Y8G("nzGhost",!1),t.R7$(2),t.Y8G("formGroup",d.form),t.R7$(10),t.Y8G("ngForOf",d.getPermissionsCategories()),t.R7$(),t.Y8G("disabled",d.form.invalid),t.R7$(),t.JRh(t.bMT(15,5,"profile.submit")))},dependencies:[c.Sq,z.qT,z.me,z.BC,z.cb,z.YS,z.j4,z.JD,s.Sy,l.aO,f.c,u.p,p.Uq,p.e,g.CA,g.Ls,g.Mo,g.zS,$.WB,V.cK,D.$g,S.D9],encapsulation:2})}return r})(),O=(()=>{class r{gql;constructor(e){this.gql=e}resolve(e,n){return this.gql.fetch({id:e.params.id})}static \u0275fac=function(n){return new(n||r)(t.KVO(v.B3S))};static \u0275prov=t.jDH({token:r,factory:r.\u0275fac})}return r})();var k=i(6807),Q=i(6354),b=i(3359),A=i(1951);const B=()=>[];function X(r,y){if(1&r&&(t.j41(0,"tr",7)(1,"td"),t.EFF(2),t.k0s()()),2&r){const e=y.$implicit;t.Y8G("routerLink","view/"+e.id),t.R7$(2),t.JRh(e.title)}}function M(r,y){if(1&r){const e=t.RV6();t.j41(0,"nz-table",5,0),t.bIt("nzQueryParams",function(d){t.eBV(e);const h=t.XpG();return t.Njj(h.tableService.onTableQueryParamsChange(d))}),t.j41(2,"thead")(3,"tr")(4,"th"),t.EFF(5),t.nI1(6,"translate"),t.k0s()()(),t.j41(7,"tbody"),t.DNE(8,X,3,2,"tr",6),t.k0s()()}if(2&r){let e;const n=y.ngIf,d=t.sdS(1);t.Y8G("nzFrontPagination",!1)("nzData",null!==(e=n)&&void 0!==e?e:t.lJ4(7,B))("nzTotal",n.length),t.R7$(5),t.SpI(" ",t.bMT(6,5,"profile.title")," "),t.R7$(3),t.Y8G("ngForOf",d.data)}}let U=(()=>{class r{route;tableService;query;constructor(e,n){this.route=e,this.tableService=n}ngOnInit(){this.query=this.route.data.pipe((0,Q.T)(e=>e.roles))}static \u0275fac=function(n){return new(n||r)(t.rXU(o.nX),t.rXU(k.a))};static \u0275cmp=t.VBU({type:r,selectors:[["app-roles-list"]],standalone:!1,decls:9,vars:7,consts:[["table",""],["nzBackIcon","","nzTitle","User Roles","nzSubtitle","Role definitions for Admin panel users.",3,"nzGhost"],["nz-button","","nzType","primary","routerLink","new"],["nz-icon","","nzType","plus"],["nzShowSizeChanger","","nzBordered","",3,"nzFrontPagination","nzData","nzTotal","nzQueryParams",4,"ngIf"],["nzShowSizeChanger","","nzBordered","",3,"nzQueryParams","nzFrontPagination","nzData","nzTotal"],["class","group cursor-pointer",3,"routerLink",4,"ngFor","ngForOf"],[1,"group","cursor-pointer",3,"routerLink"]],template:function(n,d){if(1&n&&(t.j41(0,"nz-page-header",1)(1,"nz-page-header-extra")(2,"button",2),t.nrm(3,"i",3),t.EFF(4),t.nI1(5,"translate"),t.k0s()(),t.j41(6,"nz-page-header-content"),t.DNE(7,M,9,8,"nz-table",4),t.nI1(8,"async"),t.k0s()()),2&n){let h;t.Y8G("nzGhost",!1),t.R7$(4),t.JRh(t.bMT(5,3,"profile.add")),t.R7$(3),t.Y8G("ngIf",null==(h=t.bMT(8,5,d.query))||null==h.data?null:h.data.operatorRoles)}},dependencies:[c.Sq,c.bT,b.CP,b.SO,b._4,b.IL,b.aj,b.kt,l.aO,f.c,u.p,A.Dn,$.WB,$.zR,$.ov,C.Wk,c.Jj,S.D9],encapsulation:2})}return r})(),I=(()=>{class r{gql;constructor(e){this.gql=e}resolve(e,n){return this.gql.fetch({})}static \u0275fac=function(n){return new(n||r)(t.KVO(v.m5j))};static \u0275prov=t.jDH({token:r,factory:r.\u0275fac})}return r})();const x=[{path:"",component:U,resolve:{roles:I},runGuardsAndResolvers:"paramsOrQueryParamsChange"},{path:"view/:id",component:G,resolve:{role:O}},{path:"new",component:G}];let Y=(()=>{class r{static \u0275fac=function(n){return new(n||r)};static \u0275mod=t.$C({type:r});static \u0275inj=t.G2t({providers:[I,O],imports:[C.iI.forChild(x),C.iI]})}return r})(),N=(()=>{class r{static \u0275fac=function(n){return new(n||r)};static \u0275mod=t.$C({type:r});static \u0275inj=t.G2t({imports:[R.G,Y]})}return r})()},6807:(P,F,i)=>{i.d(F,{a:()=>T});var R=i(1360),C=i(2209);let T=(()=>{class m{router;route;constructor(o,a){this.router=o,this.route=a}serializeQueryParams(o,a){const c={};if(c.pageIndex=o.pageIndex,c.pageSize=o.pageSize,null!=o.filter){const s=o.filter.filter(l=>null!=l.value&&l.value.length>0).map(l=>`${l.key}|${Array.isArray(l.value)?"in":"eq"}|${Array.isArray(l.value)?l.value.join("-"):l.value}`);null!=a.filter&&s.push(...a.filter.split(",")),c.filter=s.length>0?s.join(","):void 0}if(null!=o.sort&&o.sort.length>0){const s=o.sort.filter(l=>null!=l.value).map(l=>`${l.key}|${"ascend"==l.value?"ASC":"DESC"}`);null!=a.sort&&s.push(...a.sort.split(",")),c.sort=s.length>0?s.join(","):void 0}return c}onTableQueryParamsChange(o){const a=this.serializeQueryParams(o,this.route.snapshot.queryParams);this.router.navigate([],{relativeTo:this.route,queryParams:a,queryParamsHandling:"merge"})}filterText(o,a){const s=this.deserializeQueryParams(this.route).filter??{};s[o]=null!=a?{like:a}:{};const l=Object.keys(s).map(u=>{if(Object.keys(s[u]).length<1)return null;const p=Object.keys(s[u])[0];return`${u}|${p}|${"in"==p?s[u][p].join("-"):s[u][p]}`}).filter(u=>null!=u),f=l.length>0?l.join(","):void 0;this.router.navigate([],{relativeTo:this.route,queryParams:{filter:f},queryParamsHandling:"merge"})}filterRange(o,a){const s=this.deserializeQueryParams(this.route).filter??{};s[o]=null!=a?{between:a}:{};const l=Object.keys(s).map(u=>{if(Object.keys(s[u]).length<1)return null;const p=Object.keys(s[u])[0];return`${u}|${p}|${"in"==p||"between"==p?s[u][p].join("-"):s[u][p]}`}).filter(u=>null!=u),f=l.length>0?l.join(","):void 0;this.router.navigate([],{relativeTo:this.route,queryParams:{filter:f},queryParamsHandling:"merge"})}resetFilter(o,a){this.filterText(o,void 0),a.value=""}downloadURI(o,a){const c=document.createElement("a");c.download=a,c.href=o,c.target="_blank",document.body.appendChild(c),c.click(),document.body.removeChild(c)}deserializeQueryParams(o){const a=o.sort?o.sort.split(",").map(f=>({field:f.split("|")[0],direction:f.split("|")[1]})):[],c={};null!=o.filter&&o.filter.split(",").forEach(f=>{const u={},p=f.split("|")[1];if("in"==p){const g=f.split("|")[2].split("-");u[p]=g}else if("between"==p){const g=f.split("|")[2].split("-");u[p]={lower:g[0],upper:g[1]}}else u[p]=f.split("|")[2];c[f.split("|")[0]]=u});const s=null!=o.pageIndex?parseInt(o.pageIndex):1,l=null!=o.pageSize?parseInt(o.pageSize):10;return{sorting:a.length>0?a:void 0,paging:{offset:(s-1)*l,limit:l},filter:null!=c&&Object.keys(c).length>0?c:void 0}}static \u0275fac=function(a){return new(a||m)(R.KVO(C.Ix),R.KVO(C.nX))};static \u0275prov=R.jDH({token:m,factory:m.\u0275fac,providedIn:"root"})}return m})()}}]);