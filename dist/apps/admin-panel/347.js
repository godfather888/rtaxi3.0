"use strict";(self.webpackChunkadmin_panel=self.webpackChunkadmin_panel||[]).push([[347],{1347:(V,I,a)=>{a.r(I),a.d(I,{AnnouncementsModule:()=>w});var F=a(5885),b=a(7624),R=a(467),g=a(9417),v=a(3241),f=a(4843),n=a(1360),o=a(2209),s=a(712),l=a(8434),i=a(1011),u=a(513),p=a(6389),c=a(5930),d=a(7529),z=a(8927),G=a(1997),S=a(8960),y=a(3062),D=a(7685),L=a(8018);function x(e,j){if(1&e){const t=n.RV6();n.j41(0,"button",18),n.bIt("click",function(){n.eBV(t);const m=n.XpG(2);return n.Njj(m.deleteAnnouncement())}),n.EFF(1),n.nI1(2,"translate"),n.k0s()}2&e&&(n.R7$(),n.JRh(n.bMT(2,1,"profile.delete")))}function Q(e,j){if(1&e&&(n.j41(0,"div"),n.DNE(1,x,3,3,"button",17),n.k0s()),2&e){const t=n.XpG();n.R7$(),n.Y8G("ngIf",null!=t.form.value.id)}}function U(e,j){if(1&e&&(n.j41(0,"button",19),n.EFF(1),n.nI1(2,"translate"),n.k0s()),2&e){const t=n.XpG();n.Y8G("disabled",t.form.invalid),n.R7$(),n.JRh(n.bMT(2,2,"profile.saveChanges"))}}let $=(()=>{class e{route;routerHelper;createGQL;updateGQL;deleteGQL;fb;form;subscription;constructor(t,r,m,h,A,C){this.route=t,this.routerHelper=r,this.createGQL=m,this.updateGQL=h,this.deleteGQL=A,this.fb=C,this.form=this.fb.group({id:[null],userType:[[],g.k0.required],title:[null,g.k0.required],description:[null,g.k0.required],url:[null],dates:[null,g.k0.required]})}ngOnInit(){this.subscription=this.route.data.subscribe(t=>{const r=t.announcement;if(null==r.data.announcement?.startAt)return;const m=new Date(r.data.announcement.startAt),h=new Date(r.data.announcement.expireAt);this.form.patchValue({...r.data.announcement,dates:[m,h],userType:r.data.announcement.userType[0]})})}onSubmit(){var t=this;return(0,R.A)(function*(){const{id:r,dates:m,...h}=t.form.value,k={...h,startAt:m[0].getTime(),expireAt:m[1].getTime()};null==r?yield(0,f._)(t.createGQL.mutate({input:k})):yield(0,f._)(t.updateGQL.mutate({id:r,input:k})),t.routerHelper.goToParent(t.route)})()}deleteAnnouncement(){var t=this;return(0,R.A)(function*(){yield(0,f._)(t.deleteGQL.mutate({id:t.form.value.id})),t.routerHelper.goToParent(t.route)})()}static \u0275fac=function(r){return new(r||e)(n.rXU(o.nX),n.rXU(s.T),n.rXU(v.IoS),n.rXU(v.zJP),n.rXU(v.xrd),n.rXU(g.ze))};static \u0275cmp=n.VBU({type:e,selectors:[["app-announcement-view"]],standalone:!1,decls:36,vars:6,consts:[["nz-form","","nzLayout","vertical",3,"ngSubmit","formGroup"],["nzBackIcon","","nzTitle","Announcement","nzSubtitle","Definition of announcements & news that users will see under the menu on their app.",3,"nzGhost"],[4,"nzSpaceItem"],["nz-button","","nzType","primary","type","submit",3,"disabled",4,"nzSpaceItem"],[1,"lg:grid","lg:grid-cols-3","lg:gap-2"],["nzRequired","","nzFor","title"],["nz-input","","formControlName","title","id","title"],["nzFor","userType"],["nzMode","default","nzPlaceHolder","Please select","formControlName","userType",3,"nzMaxTagCount"],["nzLabel","Driver","nzValue","Driver"],["nzLabel","Rider","nzValue","Rider"],["nzRequired","","nzFor","description"],["nz-input","","formControlName","description","id","description"],["nzFor","url"],["nz-input","","formControlName","url","id","url"],["nzRequired","","nzFor","dates"],["id","dates","formControlName","dates",1,"w-full"],["nz-button","","nzDanger","",3,"click",4,"ngIf"],["nz-button","","nzDanger","",3,"click"],["nz-button","","nzType","primary","type","submit",3,"disabled"]],template:function(r,m){1&r&&(n.j41(0,"form",0),n.bIt("ngSubmit",function(){return m.onSubmit()}),n.j41(1,"nz-page-header",1)(2,"nz-page-header-extra")(3,"nz-space"),n.DNE(4,Q,2,1,"div",2)(5,U,3,4,"button",3),n.k0s()(),n.j41(6,"nz-page-header-content")(7,"div",4)(8,"nz-form-item")(9,"nz-form-label",5),n.EFF(10,"Title"),n.k0s(),n.j41(11,"nz-form-control"),n.nrm(12,"input",6),n.k0s()(),n.j41(13,"nz-form-item")(14,"nz-form-label",7),n.EFF(15,"User Type"),n.k0s(),n.j41(16,"nz-form-control")(17,"nz-select",8),n.nrm(18,"nz-option",9)(19,"nz-option",10),n.k0s()()(),n.j41(20,"nz-form-item")(21,"nz-form-label",11),n.EFF(22,"Description"),n.k0s(),n.j41(23,"nz-form-control"),n.nrm(24,"input",12),n.k0s()(),n.j41(25,"nz-form-item")(26,"nz-form-label",13),n.EFF(27,"URL"),n.k0s(),n.j41(28,"nz-form-control"),n.nrm(29,"input",14),n.k0s()(),n.j41(30,"nz-form-item")(31,"nz-form-label",15),n.EFF(32),n.nI1(33,"translate"),n.k0s(),n.j41(34,"nz-form-control"),n.nrm(35,"nz-range-picker",16),n.k0s()()()()()()),2&r&&(n.Y8G("formGroup",m.form),n.R7$(),n.Y8G("nzGhost",!1),n.R7$(16),n.Y8G("nzMaxTagCount",3),n.R7$(15),n.JRh(n.bMT(33,4,"coupons.availabilityTime")))},dependencies:[l.bT,g.qT,g.me,g.BC,g.cb,g.j4,g.JD,i.Sy,u.aO,p.c,c.p,d.Uq,d.e,z.CA,z.Ls,z.Mo,z.zS,G.ld,G.WI,S.SN,S.vw,y.WB,y.zR,y.ov,D.U5,D.Dq,L.D9],encapsulation:2})}return e})(),E=(()=>{class e{gql;constructor(t){this.gql=t}resolve(t,r){return this.gql.fetch({id:t.params.id})}static \u0275fac=function(r){return new(r||e)(n.KVO(v.LFK))};static \u0275prov=n.jDH({token:e,factory:e.\u0275fac})}return e})();var O=a(6807),M=a(6354),T=a(3359),B=a(1951);function X(e,j){if(1&e&&(n.j41(0,"tr",7)(1,"td")(2,"div")(3,"div",8),n.EFF(4),n.k0s(),n.j41(5,"div",9),n.EFF(6),n.k0s()()(),n.j41(7,"td"),n.EFF(8),n.nI1(9,"date"),n.nI1(10,"date"),n.k0s()()),2&e){const t=j.$implicit;n.Y8G("routerLink","view/"+t.id),n.R7$(4),n.SpI(" ",t.title," "),n.R7$(2),n.SpI(" ",t.description," "),n.R7$(2),n.Lme("",n.i5U(9,5,t.startAt,"mediumDate")," - ",n.i5U(10,8,t.expireAt,"mediumDate"),"")}}function N(e,j){if(1&e){const t=n.RV6();n.j41(0,"nz-table",5,0),n.bIt("nzQueryParams",function(m){n.eBV(t);const h=n.XpG();return n.Njj(h.tableService.onTableQueryParamsChange(m))}),n.j41(2,"thead")(3,"tr")(4,"th"),n.EFF(5),n.nI1(6,"translate"),n.k0s(),n.j41(7,"th"),n.EFF(8),n.nI1(9,"translate"),n.k0s()()(),n.j41(10,"tbody"),n.DNE(11,X,11,11,"tr",6),n.k0s()()}if(2&e){const t=j.ngIf,r=n.sdS(1);n.Y8G("nzFrontPagination",!1)("nzData",t.nodes)("nzTotal",t.totalCount),n.R7$(5),n.JRh(n.bMT(6,6,"profile.title")),n.R7$(3),n.JRh(n.bMT(9,8,"profile.dateTime")),n.R7$(3),n.Y8G("ngForOf",r.data)}}let H=(()=>{class e{tableService;route;query;constructor(t,r){this.tableService=t,this.route=r}ngOnInit(){this.query=this.route.data.pipe((0,M.T)(t=>t.announcements))}static \u0275fac=function(r){return new(r||e)(n.rXU(O.a),n.rXU(o.nX))};static \u0275cmp=n.VBU({type:e,selectors:[["app-announcement-list"]],standalone:!1,decls:9,vars:7,consts:[["table",""],["nzBackIcon","","nzTitle","Announcements","nzSubtitle","List of all the announcements",3,"nzGhost"],["nz-button","","nzType","primary","routerLink","new"],["nz-icon","","nzType","plus"],["nzShowSizeChanger","","nzBordered","",3,"nzFrontPagination","nzData","nzTotal","nzQueryParams",4,"ngIf"],["nzShowSizeChanger","","nzBordered","",3,"nzQueryParams","nzFrontPagination","nzData","nzTotal"],["class","group cursor-pointer",3,"routerLink",4,"ngFor","ngForOf"],[1,"group","cursor-pointer",3,"routerLink"],[1,"table-first-line"],[1,"table-second-line"]],template:function(r,m){if(1&r&&(n.j41(0,"nz-page-header",1)(1,"nz-page-header-extra")(2,"button",2),n.nrm(3,"i",3),n.EFF(4),n.nI1(5,"translate"),n.k0s()(),n.j41(6,"nz-page-header-content"),n.DNE(7,N,12,10,"nz-table",4),n.nI1(8,"async"),n.k0s()()),2&r){let h;n.Y8G("nzGhost",!1),n.R7$(4),n.JRh(n.bMT(5,3,"profile.add")),n.R7$(3),n.Y8G("ngIf",null==(h=n.bMT(8,5,m.query))||null==h.data?null:h.data.announcements)}},dependencies:[b.Wk,l.Sq,l.bT,T.CP,T.SO,T._4,T.IL,T.aj,T.kt,u.aO,p.c,c.p,B.Dn,y.WB,y.zR,y.ov,l.Jj,l.vh,L.D9],encapsulation:2})}return e})(),P=(()=>{class e{paging;gql;constructor(t,r){this.paging=t,this.gql=r}resolve(t,r){const m=this.paging.deserializeQueryParams(t.queryParams);return this.gql.fetch(m)}static \u0275fac=function(r){return new(r||e)(n.KVO(O.a),n.KVO(v.ZO5))};static \u0275prov=n.jDH({token:e,factory:e.\u0275fac})}return e})();const Y=[{path:"",component:H,resolve:{announcements:P},runGuardsAndResolvers:"paramsOrQueryParamsChange"},{path:"view/:id",component:$,resolve:{announcement:E}},{path:"new",component:$}];let J=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275mod=n.$C({type:e});static \u0275inj=n.G2t({providers:[P,E],imports:[b.iI.forChild(Y),b.iI]})}return e})(),w=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275mod=n.$C({type:e});static \u0275inj=n.G2t({imports:[J,F.G]})}return e})()},6807:(V,I,a)=>{a.d(I,{a:()=>R});var F=a(1360),b=a(2209);let R=(()=>{class f{router;route;constructor(o,s){this.router=o,this.route=s}serializeQueryParams(o,s){const l={};if(l.pageIndex=o.pageIndex,l.pageSize=o.pageSize,null!=o.filter){const i=o.filter.filter(u=>null!=u.value&&u.value.length>0).map(u=>`${u.key}|${Array.isArray(u.value)?"in":"eq"}|${Array.isArray(u.value)?u.value.join("-"):u.value}`);null!=s.filter&&i.push(...s.filter.split(",")),l.filter=i.length>0?i.join(","):void 0}if(null!=o.sort&&o.sort.length>0){const i=o.sort.filter(u=>null!=u.value).map(u=>`${u.key}|${"ascend"==u.value?"ASC":"DESC"}`);null!=s.sort&&i.push(...s.sort.split(",")),l.sort=i.length>0?i.join(","):void 0}return l}onTableQueryParamsChange(o){const s=this.serializeQueryParams(o,this.route.snapshot.queryParams);this.router.navigate([],{relativeTo:this.route,queryParams:s,queryParamsHandling:"merge"})}filterText(o,s){const i=this.deserializeQueryParams(this.route).filter??{};i[o]=null!=s?{like:s}:{};const u=Object.keys(i).map(c=>{if(Object.keys(i[c]).length<1)return null;const d=Object.keys(i[c])[0];return`${c}|${d}|${"in"==d?i[c][d].join("-"):i[c][d]}`}).filter(c=>null!=c),p=u.length>0?u.join(","):void 0;this.router.navigate([],{relativeTo:this.route,queryParams:{filter:p},queryParamsHandling:"merge"})}filterRange(o,s){const i=this.deserializeQueryParams(this.route).filter??{};i[o]=null!=s?{between:s}:{};const u=Object.keys(i).map(c=>{if(Object.keys(i[c]).length<1)return null;const d=Object.keys(i[c])[0];return`${c}|${d}|${"in"==d||"between"==d?i[c][d].join("-"):i[c][d]}`}).filter(c=>null!=c),p=u.length>0?u.join(","):void 0;this.router.navigate([],{relativeTo:this.route,queryParams:{filter:p},queryParamsHandling:"merge"})}resetFilter(o,s){this.filterText(o,void 0),s.value=""}downloadURI(o,s){const l=document.createElement("a");l.download=s,l.href=o,l.target="_blank",document.body.appendChild(l),l.click(),document.body.removeChild(l)}deserializeQueryParams(o){const s=o.sort?o.sort.split(",").map(p=>({field:p.split("|")[0],direction:p.split("|")[1]})):[],l={};null!=o.filter&&o.filter.split(",").forEach(p=>{const c={},d=p.split("|")[1];if("in"==d){const z=p.split("|")[2].split("-");c[d]=z}else if("between"==d){const z=p.split("|")[2].split("-");c[d]={lower:z[0],upper:z[1]}}else c[d]=p.split("|")[2];l[p.split("|")[0]]=c});const i=null!=o.pageIndex?parseInt(o.pageIndex):1,u=null!=o.pageSize?parseInt(o.pageSize):10;return{sorting:s.length>0?s:void 0,paging:{offset:(i-1)*u,limit:u},filter:null!=l&&Object.keys(l).length>0?l:void 0}}static \u0275fac=function(s){return new(s||f)(F.KVO(b.Ix),F.KVO(b.nX))};static \u0275prov=F.jDH({token:f,factory:f.\u0275fac,providedIn:"root"})}return f})()}}]);